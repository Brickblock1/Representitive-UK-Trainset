# 1 "rukts.pnml"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "rukts.pnml"
disable_item(FEAT_TRAINS);
# 1 "src/CODE/header.pnml" 1
grf{
 grfid: "RUKT";
 name: string(STR_GRF_NAME);
 desc: string(STR_GRF_DESC);
 version: 1;
 min_compatible_version: 0;
 param 0{
  colour_scheme_1{
   type: bool;
   name: string(STR_PARAM_COLOURSCHEME_NAME);
   desc: string(STR_PARAM_COLOURSCHEME_DESC);
   bit : 1;
  }
  coaches_take_mail{
   type: bool;
   name: string(STR_PARAM_COACHMAIL_NAME);
   desc: string(STR_PARAM_COACHMAIL_DESC);
   bit : 2;
  }
  livery_choice{
   type: bool;
   name: string(STR_PARAM_LIVERY_CHOICE_NAME);
   desc: string(STR_PARAM_LIVERY_CHOICE_DESC);
   bit : 3;
  }
 }
}

// Tractive Effort Coefficient = Actual Tractive effort / Weight / 10
# 3 "rukts.pnml" 2
# 1 "src/CODE/cargo_table.pnml" 1
cargotable {
//Default cargos
   PASS, MAIL, COAL, FOOD, GOLD, GOOD, GRAI, IORE, LVST, OIL_, PAPR, STEL, VALU, WHEA, WOOD,

//Tropical cargos
   CORE, DIAM, FRUT, MAIZ, RUBR, WATR,

//ECS
   AORE, BDMT, BRCK, CERA, CERE, CMNT, DYES, FERT, FICR, FISH, GLAS, LIME, OLSD, PETR, PLAS, POTA, RFPR, SAND, SULP, TOUR, VEHI, WDPR, WOOL,

//FIRS
   BEER, CLAY, ENSP, FMSP, FRVG, GRVL, MILK, MNSP, PHOS, PORE, RCYC, SCMT, SGBT, SGCN, JAVA, COPR, SUGR,
   }
# 4 "rukts.pnml" 2
# 1 "src/CODE/railtype_table.pnml" 1
railtypetable {
    RAIL,
 ELRL,
 SAA3: ["3RDR", ELRL],
 SAAZ: ["3RDC", ELRL],
 SAA4: [SAA3, ELRL],
}
# 5 "rukts.pnml" 2
# 1 "src/CODE/alignments.pnml" 1
//template_x_y where x is length and y is no. views

template template_purchase(x,y){
 [ x, y, 79, 12, -39, -6]
}

template template_purchase_short(x,y){
 [ x, y, 55, 12, -39, -6]
}

template template_dualhead_purchase(x,y){
 [ x+77, y+11, 1, 1, 0, 0]
 [ x+77, y+11, 1, 1, 0, 0]
 [ x, y, 78, 12, -54, -6]
 [ x+77, y+11, 1, 1, 0, 0]
 [ x+77, y+11, 1, 1, 0, 0]
 [ x+77, y+11, 1, 1, 0, 0]
 [ x+77, y+11, 1, 1, 0, 0]
}

template template_uklight(x,y){
 [x+0,y,8,24,-3,-11] //North
 [x+10,y,20,16,-13,-8] //North East
 [x+32,y,32,13,-16,-9] //East
 [x+66,y,20,16,-5,-8] //South East
 [x+88,y,8,24,-3,-11] //South
 [x+98,y,20,16,-13,-8] //South West
 [x+120,y,32,13,-16,-9] //West
 [x+154,y,20,16,-5,-8] //North West
}

template template_uklight_reverse(x,y){
 [x+88,y,8,24,-3,-11] //South
 [x+98,y,20,16,-13,-8] //South West
 [x+120,y,32,13,-16,-9] //West
 [x+154,y,20,16,-5,-8] //North West
 [x+0,y,8,24,-3,-11] //North
 [x+10,y,20,16,-13,-8] //North East
 [x+32,y,32,13,-16,-9] //East
 [x+66,y,20,16,-5,-8] //South East
}

template template_8_8(x,y){
    [ x, y, 8, 24, -3, -12]
    [ x+10, y, 21, 17, -12, -10]
    [ x+33, y, 32, 12, -16, -8]
    [ x+67, y, 21, 17, -5, -10]
    [ x+90, y, 8, 24, -3, -12]
    [ x+100, y, 21, 17, -12, -10]
    [ x+123, y, 32, 12, -16, -8]
    [ x+157, y, 21, 17, -5, -10]
}

template template_8_4(x,y){
    [ x, y, 8, 24, -3, -12]
    [ x+10, y, 21, 17, -12, -10]
    [ x+33, y, 32, 12, -16, -8]
    [ x+67, y, 21, 17, -5, -10]
}

template template_7_8(x,y){
    [ x, y, 8, 22, -3, -11]
    [ x+10, y, 19, 17, -11, -10]
    [ x+31, y, 28, 12, -14, -8]
    [ x+61, y, 19, 17, -4, -9]
    [ x+82, y, 8, 22, -3, -11]
    [ x+92, y, 19, 17, -11, -10]
    [ x+113, y, 28, 12, -14, -8]
    [ x+143, y, 19, 17, -4, -9]
}

template template_7_4(x,y){
    [ x, y, 8, 22, -3, -11]
    [ x+10, y, 19, 17, -11, -10]
    [ x+31, y, 28, 12, -14, -8]
    [ x+61, y, 19, 17, -4, -9]
}

template template_8_8_networker(x,y){
    [ x, y, 8, 24, -3, -12]
    [ x+10, y, 21, 18, -13, -10]
    [ x+33, y, 32, 12, -16, -8]
    [ x+67, y, 21, 18, -6, -10]
    [ x+90, y, 8, 24, -3, -12]
    [ x+100, y, 21, 18, -13, -10]
    [ x+123, y, 32, 12, -16, -8]
    [ x+157, y, 21, 18, -6, -10]
}

template template_8_8_networker_reverse(x,y){
    [ x+90, y, 8, 24, -3, -12]
    [ x+100, y, 21, 18, -13, -10]
    [ x+123, y, 32, 12, -16, -8]
    [ x+157, y, 21, 18, -6, -10]
    [ x, y, 8, 24, -3, -12]
    [ x+10, y, 21, 18, -13, -10]
    [ x+33, y, 32, 12, -16, -8]
    [ x+67, y, 21, 18, -6, -10]
}
# 6 "rukts.pnml" 2
# 1 "src/CODE/era_definitions.pnml" 1
# 7 "rukts.pnml" 2
# 1 "src/CODE/visual_effects.pnml" 1
switch (FEAT_TRAINS, SELF, vfx_ohle, [STORE_TEMP(create_effect(EFFECT_SPRITE_ELECTRIC, 0, 0, 10), 0x100)]) {
    return 1;
}

switch (FEAT_TRAINS, SELF, vfx_3rd, [STORE_TEMP(create_effect(EFFECT_SPRITE_ELECTRIC, 0, 0, -7), 0x100)]) {
    return 1;
}

switch (FEAT_TRAINS, SELF, vfx_diesel_default, [STORE_TEMP(create_effect(EFFECT_SPRITE_DIESEL, 0, 0, 10), 0x100)]) {
    return 1;
}

switch(FEAT_TRAINS, SELF, vfx_dual_voltage, current_railtype){
 SAA3: vfx_3rd;
 vfx_ohle;
}

switch(FEAT_TRAINS, SELF, vfx_3rd_only, current_railtype){
 SAA3: vfx_3rd;
 return 0;
}

switch(FEAT_TRAINS, SELF, vfx_ohle_only, current_railtype){
 ELRL: vfx_ohle;
 SAAZ: vfx_ohle;
 return 0;
}
# 8 "rukts.pnml" 2
# 1 "src/CODE/sound_effects.pnml" 1
//Sound deciding switches

switch(FEAT_TRAINS, PARENT, sw_sfx_electric_old_running, current_speed){
 0..13 : sound("sfx/86_coast_2.wav") ;
 14..36 : sound("sfx/86_coast_1.wav") ;
 sound("sfx/86_coast_3.wav") ;
}

switch(FEAT_TRAINS, PARENT, sw_sfx_electric_modern_running, current_speed){
 0..22 : sound("sfx/800_run.wav") ;
 sound("sfx/800_coast.wav") ;
}


//Sound effect switches

switch(FEAT_TRAINS, SELF, sw_sfx_electric_loco_old, getbits(extra_callback_info1, 0, 8)){
 SOUND_EVENT_STOPPED : sound("sfx/86_idle.wav") ;
 //SOUND_EVENT_VISUAL_EFFECT : sound("sfx/.wav") ;
 SOUND_EVENT_RUNNING : sw_sfx_electric_old_running ;
 SOUND_EVENT_START : sound("sfx/86_depart.wav") ;
 SOUND_EVENT_BREAKDOWN : SOUND_TRAIN_BREAKDOWN ;
 SOUND_EVENT_TUNNEL : sound("sfx/40_horn.wav") ;
}

switch(FEAT_TRAINS, SELF, sw_sfx_electric_loco_modern, getbits(extra_callback_info1, 0, 8)){
 SOUND_EVENT_STOPPED : sound("sfx/800_idle.wav") ;
 //SOUND_EVENT_VISUAL_EFFECT : sound("sfx/.wav") ;
 SOUND_EVENT_RUNNING : sw_sfx_electric_modern_running ;
 SOUND_EVENT_START : sound("sfx/40_horn.wav") ;
 SOUND_EVENT_BREAKDOWN : SOUND_TRAIN_BREAKDOWN ;
 SOUND_EVENT_TUNNEL : sound("sfx/40_horn.wav") ;
}

switch(FEAT_TRAINS, SELF, sw_sfx_diesel_loco_modern, getbits(extra_callback_info1, 0, 8)){
 SOUND_EVENT_STOPPED : sound("sfx/70_idle.wav") ;
 SOUND_EVENT_VISUAL_EFFECT : sound("sfx/70_run.wav") ;
 SOUND_EVENT_RUNNING : sound("sfx/70_coast.wav") ;
 SOUND_EVENT_START : sound("sfx/70_horn.wav") ;
 SOUND_EVENT_BREAKDOWN : SOUND_TRAIN_BREAKDOWN ;
 SOUND_EVENT_TUNNEL : sound("sfx/70_horn.wav") ;
}

switch(FEAT_TRAINS, SELF, sw_sfx_diesel_loco_ee, getbits(extra_callback_info1, 0, 8)){
 SOUND_EVENT_STOPPED : sound("sfx/40_idle.wav") ;
 SOUND_EVENT_VISUAL_EFFECT : sound("sfx/40_run.wav") ;
 SOUND_EVENT_RUNNING : sound("sfx/40_coast.wav") ;
 SOUND_EVENT_START : sound("sfx/40_horn.wav") ;
 SOUND_EVENT_BREAKDOWN : SOUND_TRAIN_BREAKDOWN ;
 SOUND_EVENT_TUNNEL : sound("sfx/40_horn.wav") ;
}
/*

switch(FEAT_TRAINS, SELF, sw_sfx_emu_one, getbits(extra_callback_info1, 0, 8)){

	SOUND_EVENT_STOPPED       : sound("sfx/.wav") ;

	//SOUND_EVENT_VISUAL_EFFECT : sound("sfx/.wav") ;

	SOUND_EVENT_RUNNING       : sound("sfx/.wav") ;

	SOUND_EVENT_START         : sound("sfx/40_horn.wav") ;

	SOUND_EVENT_BREAKDOWN     : SOUND_TRAIN_BREAKDOWN ;

	SOUND_EVENT_TUNNEL        : sound("sfx/40_horn.wav") ;

}

*/
# 62 "src/CODE/sound_effects.pnml"
switch(FEAT_TRAINS, SELF, sw_sfx_dmu_one, getbits(extra_callback_info1, 0, 8)){
 SOUND_EVENT_STOPPED : sound("sfx/dmu_idle.wav") ;
 SOUND_EVENT_VISUAL_EFFECT : sound("sfx/dmu_run.wav") ;
 SOUND_EVENT_RUNNING : sound("sfx/dmu_coast.wav") ;
 SOUND_EVENT_START : sound("sfx/40_horn.wav") ;
 SOUND_EVENT_BREAKDOWN : SOUND_TRAIN_BREAKDOWN ;
 SOUND_EVENT_TUNNEL : sound("sfx/40_horn.wav") ;
}
# 9 "rukts.pnml" 2
# 1 "src/CODE/coupling_restrictions.pnml" 1
switch(FEAT_TRAINS, SELF, sw_all_but_MU90, vehicle_type_id) {
    item_MU90: return string(STR_MU90_NO_COUPLE);
    return CB_RESULT_ATTACH_ALLOW;
}
# 10 "rukts.pnml" 2
# 1 "src/WAGON/Mk1.pnml" 1
spriteset(spriteset_Mk1_lined, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(0, 25)
}

spriteset(spriteset_Mk1_lined_brake, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(179, 25)
}

spriteset(spriteset_Mk1_2_tone, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(0, 50)
}

spriteset(spriteset_Mk1_2_tone_brake, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(179, 50)
}

spriteset(spriteset_Mk1_nse, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(0, 75)
}

spriteset(spriteset_Mk1_nse_brake, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(179, 75)
}

spriteset(spriteset_Mk1_rr, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(0, 100)
}

spriteset(spriteset_Mk1_rr_brake, "gfx/WAGON/mark_1.png") {
 template_8_8_networker(179, 100)
}

//Purchase sprites

spriteset(spriteset_Mk1_lined_purchase, "gfx/WAGON/mark_1.png") {
 template_purchase(0, 138)
}

spriteset(spriteset_Mk1_2_tone_purchase, "gfx/WAGON/mark_1.png") {
 template_purchase(0, 151)
}

spriteset(spriteset_Mk1_nse_purchase, "gfx/WAGON/mark_1.png") {
 template_purchase(0, 164)
}

spriteset(spriteset_Mk1_rr_purchase, "gfx/WAGON/mark_1.png") {
 template_purchase(0, 177)
}

switch(FEAT_TRAINS, SELF, sw_Mk1_lined_brake_f, position_in_consist){
 0: spriteset_Mk1_lined_brake;
 spriteset_Mk1_lined;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_lined_brake, position_in_consist_from_end){
 0: spriteset_Mk1_lined;
 sw_Mk1_lined_brake_f;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_2_tone_brake_f, position_in_consist){
 0: spriteset_Mk1_2_tone_brake;
 spriteset_Mk1_2_tone;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_2_tone_brake, position_in_consist_from_end){
 0: spriteset_Mk1_2_tone;
 sw_Mk1_2_tone_brake_f;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_nse_brake_f, position_in_consist){
 0: spriteset_Mk1_nse_brake;
 spriteset_Mk1_nse;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_nse_brake, position_in_consist_from_end){
 0: spriteset_Mk1_nse;
 sw_Mk1_nse_brake_f;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_rr_brake_f, position_in_consist){
 0: spriteset_Mk1_rr_brake;
 spriteset_Mk1_rr;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_rr_brake, position_in_consist_from_end){
 0: spriteset_Mk1_rr;
 sw_Mk1_rr_brake_f;
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_gfx_lined, TRIGGER_VEHICLE_SERVICE){
 1 : sw_Mk1_lined_brake;
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_gfx_crimson_cream, TRIGGER_VEHICLE_SERVICE){
 1 : sw_Mk1_2_tone_brake;
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_gfx_blue_grey, TRIGGER_VEHICLE_SERVICE){
 1 : sw_Mk1_2_tone_brake;
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_gfx_nse, TRIGGER_VEHICLE_SERVICE){
 1 : sw_Mk1_nse_brake;
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_gfx_rr, TRIGGER_VEHICLE_SERVICE){
 1 : sw_Mk1_rr_brake;
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_gfx_crest, TRIGGER_VEHICLE_SERVICE){
 1 : sw_Mk1_lined_brake;
 1 : sw_Mk1_2_tone_brake;
}

random_switch(FEAT_TRAINS, PARENT, sw_mk1_gfx_sectorisation){
 1 : sw_Mk1_nse_brake;
 1 : sw_Mk1_rr_brake;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_auto_livery_decider, current_year){
 1948 .. 1960:sw_mk1_gfx_crimson_cream;
 1961 .. 1966:sw_mk1_gfx_crest;
 1967 .. 1970:sw_mk1_gfx_blue_grey;
 1971 .. 1982:sw_mk1_gfx_blue_grey;
 1983 .. 1995:sw_mk1_gfx_sectorisation;
 return sw_mk1_gfx_lined;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_purchase, current_year){
 1948 .. 1960:spriteset_Mk1_2_tone_purchase;
 1961 .. 1966:spriteset_Mk1_lined_purchase;
 1967 .. 1970:spriteset_Mk1_2_tone_purchase;
 1971 .. 1982:spriteset_Mk1_2_tone_purchase;
 1983 .. 1995:spriteset_Mk1_nse_purchase;
 return spriteset_Mk1_lined_purchase;
}

//Selected liveries

switch(FEAT_TRAINS, SELF, sw_Mk1_manual_livery_decider, cargo_subtype){
 0:sw_mk1_gfx_crimson_cream;
 1:sw_mk1_gfx_lined;
 2:sw_mk1_gfx_blue_grey;
 3:sw_mk1_gfx_nse;
 4:sw_mk1_gfx_rr;
 5:sw_mk1_gfx_lined;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_livery_choice_decider, livery_choice){
 1 : sw_Mk1_manual_livery_decider;
 sw_Mk1_auto_livery_decider;
}

//Sprite stacking
switch(FEAT_TRAINS, SELF, sw_Mk1_default, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_Mk1_livery_choice_decider;
}

//Cargo refit text
switch(FEAT_TRAINS, SELF, sw_Mk1_refit_text, cargo_subtype){
 0 : string(STR_LIVERY_CRIMSON_CREAM);
 1 : string(STR_LIVERY_MAROON);
 2 : string(STR_LIVERY_BRBLUE);
 3 : string(STR_LIVERY_NSE);
 4 : string(STR_LIVERY_REG_RAILWAYS);
 5 : string(STR_LIVERY_WCRC);
 return CB_RESULT_NO_TEXT ;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_refit_text_decider, livery_choice){
 1 : sw_Mk1_refit_text ;
 return CB_RESULT_NO_TEXT ;
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_colour_crimson_cream, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_RED, COLOUR_YELLOW);
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_colour_maroon, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_RED, COLOUR_YELLOW);
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_colour_br_blue, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE);
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_colour_nse, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED);
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_colour_rr, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_BLUE);
}

random_switch(FEAT_TRAINS, SELF, sw_mk1_colour_wcrc, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_RED, COLOUR_YELLOW);
}

random_switch(FEAT_TRAINS, PARENT, sw_mk1_colour_sectorisation){
 dependent : sw_mk1_gfx_sectorisation;
 1 : sw_mk1_colour_nse;
 1 : sw_mk1_colour_rr;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_auto_colour_decider, current_year){
 1948 .. 1960:sw_mk1_colour_crimson_cream;
 1961 .. 1966:sw_mk1_colour_maroon;
 1967 .. 1970:sw_mk1_colour_br_blue;
 1971 .. 1982:sw_mk1_colour_br_blue;
 1983 .. 1995:sw_mk1_colour_sectorisation;
 return sw_mk1_colour_wcrc;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_manual_colour_decider, cargo_subtype){
 0 : sw_mk1_colour_crimson_cream;
 1 : sw_mk1_colour_maroon;
 2 : sw_mk1_colour_br_blue;
 3 : sw_mk1_colour_nse;
 4 : sw_mk1_colour_rr;
 5 : sw_mk1_colour_wcrc;
 return CB_RESULT_NO_TEXT ;
}

switch(FEAT_TRAINS, SELF, sw_Mk1_livery_choice_colour_decider, livery_choice){
 1 : sw_Mk1_manual_colour_decider;
 sw_Mk1_auto_colour_decider;
}

/*switch(FEAT_TRAINS, PARENT, sw_Mk1_colour_mapping_by_train, vehicle_id){

	1 : 

	sw_Mk1_livery_choice_colour_decider;

}*/
# 235 "src/WAGON/Mk1.pnml"
switch(FEAT_TRAINS, SELF, sw_Mk1_colour_mapping, colour_scheme_1){
 1 : sw_Mk1_livery_choice_colour_decider;
 palette_2cc(company_colour1, company_colour2) ;
}

item (FEAT_TRAINS, item_Mk1, 9010) {
 property {
  name: string(STR_NAME_MK1);
  climates_available: ALL_CLIMATES;
  introduction_date: date(1953, 1, 1);
  model_life: 15;
  retire_early: 1;
  vehicle_life: 50;
  reliability_decay: 7;
  refittable_cargo_classes: CC_PASSENGERS;
  cargo_allow_refit: [PASS, TOUR];
  loading_speed: 29;
  cost_factor: 35;
  running_cost_factor: 45;
  sprite_id: SPRITE_ID_NEW_TRAIN;
  speed: 100 mph;
  misc_flags: bitmask(TRAIN_FLAG_2CC);
  refit_cost: 0;
  track_type: RAIL;
  ai_special_flag: AI_FLAG_CARGO;
  power: 0 hp;
  running_cost_base: RUNNING_COST_NONE;
  dual_headed: 0;
  default_cargo_type: PASS;
  cargo_capacity: 60;
  weight: 35 ton;
  tractive_effort_coefficient: 0.07;
  air_drag_coefficient: 0.08;
  length: 8;
  bitmask_vehicle_info: 0;
  cargo_age_period: 185;
 }
 graphics {
 can_attach_wagon: CB_RESULT_ATTACH_ALLOW;
 default: sw_Mk1_default;
 colour_mapping: sw_Mk1_colour_mapping;
 cargo_subtype_text: sw_Mk1_refit_text_decider;
 purchase: sw_Mk1_purchase;
}
}

/*item (FEAT_TRAINS, item_Mk1_mail, 9011) {

	property {

		name: 							string(STR_NAME_MK2_MAIL);

		climates_available: 			ALL_CLIMATES;

		introduction_date:				date(1953, 1, 1);

		model_life:						15;

		retire_early:					1;

		vehicle_life:					50;

		reliability_decay:				7;

		refittable_cargo_classes:		CC_MAIL;

		cargo_allow_refit:				[MAIL];

		loading_speed:					29;

		cost_factor:					20;

		running_cost_factor:			0;

		sprite_id:						SPRITE_ID_NEW_TRAIN;

		speed:							100 mph;

		misc_flags:						bitmask(TRAIN_FLAG_2CC);

		refit_cost:						0;

		track_type:						RAIL;

		ai_special_flag:				AI_FLAG_CARGO;

		power:							0 hp;

		running_cost_base:				RUNNING_COST_NONE;

		dual_headed:					0;

		default_cargo_type:				PASS;

		cargo_capacity:					60;

		weight:							35 ton;

		tractive_effort_coefficient:	0.07;

		air_drag_coefficient:			0.08;

		length:							8;

		bitmask_vehicle_info:			0;

		cargo_age_period:				185;

	}

	graphics {

	can_attach_wagon:					CB_RESULT_ATTACH_ALLOW;

	colour_mapping:						return 0;

}

}*/
# 11 "rukts.pnml" 2
//#include "src/WAGON/MK3.pnml"
# 1 "src/WAGON/Mk2.pnml" 1
//Mark 2

/*

	[x+85,y,8,23,-3,-10] //South

	[x+95,y,18,15,-12,-8] //South West

	[x+115,y,33,13,-17,-9] //West

	[x+150,y,18,15,-3,-8] //North West

*/
# 11 "src/WAGON/Mk2.pnml"
//Templates

template template_Mk2_single(x,y){
 [x+0,y,8,23,-3,-11] //North
 [x+10,y,20,16,-14,-8] //North East
 [x+32,y,33,13,-17,-9] //East
 [x+67,y,20,16,-5,-8] //South East
}

template template_Mk2_double(x,y){
 [x+0,y,8,23,-3,-11] //North
 [x+10,y,20,16,-14,-8] //North East
 [x+32,y,33,13,-17,-9] //East
 [x+67,y,20,16,-5,-8] //South East
 [x+89,y,8,23,-3,-11] //South
 [x+99,y,20,16,-14,-8] //South West
 [x+121,y,33,13,-17,-9] //West
 [x+156,y,20,16,-5,-8] //North West
}

template template_Mk2_double_reverse(x,y){
 [x+89,y,8,23,-3,-11] //South
 [x+99,y,20,16,-14,-8] //South West
 [x+121,y,33,13,-17,-9] //West
 [x+156,y,20,16,-5,-8] //North West
 [x+0,y,8,23,-3,-11] //North
 [x+10,y,20,16,-14,-8] //North East
 [x+32,y,33,13,-17,-9] //East
 [x+67,y,20,16,-5,-8] //South East
}


//Spritesets

spriteset(gfx_mk2_brblue_f_tso , "gfx/WAGON/mark_2.png"){template_Mk2_single(0,0)}
spriteset(gfx_mk2_brblue_f_bso , "gfx/WAGON/mark_2.png"){template_Mk2_double(0,25)}
spriteset(gfx_mk2_brblue_f_bso_reverse , "gfx/WAGON/mark_2.png"){template_Mk2_double_reverse(0,25)}
spriteset(gfx_mk2_brblue_a_tso , "gfx/WAGON/mark_2.png"){template_Mk2_single(0,50)}
spriteset(gfx_mk2_brblue_a_bso , "gfx/WAGON/mark_2.png"){template_Mk2_double(0,75)}
spriteset(gfx_mk2_brblue_a_bso_reverse , "gfx/WAGON/mark_2.png"){template_Mk2_double_reverse(0,75)}
spriteset(gfx_mk2_intercity_f_tso , "gfx/WAGON/mark_2.png"){template_Mk2_single(0,100)}
spriteset(gfx_mk2_intercity_f_bso , "gfx/WAGON/mark_2.png"){template_Mk2_double(0,125)}
spriteset(gfx_mk2_intercity_f_dbso , "gfx/WAGON/mark_2_dbso.png"){template_Mk2_double(0,0)}
spriteset(gfx_mk2_intercity_f_bso_reverse , "gfx/WAGON/mark_2.png"){template_Mk2_double_reverse(0,125)}
spriteset(gfx_mk2_regional_a_tso , "gfx/WAGON/mark_2.png"){template_Mk2_single(0,150)}
spriteset(gfx_mk2_regional_a_bso , "gfx/WAGON/mark_2.png"){template_Mk2_double(0,175)}
spriteset(gfx_mk2_regional_a_bso_reverse , "gfx/WAGON/mark_2.png"){template_Mk2_double_reverse(0,175)}
spriteset(gfx_mk2_virgin_f_tso , "gfx/WAGON/mark_2.png"){template_Mk2_single(0,200)}
spriteset(gfx_mk2_virgin_f_bso , "gfx/WAGON/mark_2.png"){template_Mk2_double(0,225)}
spriteset(gfx_mk2_virgin_f_bso_reverse , "gfx/WAGON/mark_2.png"){template_Mk2_double_reverse(0,225)}
spriteset(gfx_mk2_generic_a_tso , "gfx/WAGON/mark_2.png"){template_Mk2_single(0,250)}
spriteset(gfx_mk2_generic_a_bso , "gfx/WAGON/mark_2.png"){template_Mk2_double(0,275)}
spriteset(gfx_mk2_generic_a_bso_reverse , "gfx/WAGON/mark_2.png"){template_Mk2_double_reverse(0,275)}
spriteset(gfx_mk2_directrail_f_tso , "gfx/WAGON/mark_2.png"){template_Mk2_single(0,300)}
spriteset(gfx_mk2_directrail_f_bso , "gfx/WAGON/mark_2.png"){template_Mk2_double(0,325)}
spriteset(gfx_mk2_directrail_f_bso_reverse , "gfx/WAGON/mark_2.png"){template_Mk2_double_reverse(0,325)}

spriteset(gfx_mk2_purchase_brblue , "gfx/WAGON/mark_2.png"){template_purchase(89,50)}
spriteset(gfx_mk2_purchase_regional , "gfx/WAGON/mark_2.png"){template_purchase(89,150)}
spriteset(gfx_mk2_purchase_virgin , "gfx/WAGON/mark_2.png"){template_purchase(89,200)}
spriteset(gfx_mk2_purchase_directrail , "gfx/WAGON/mark_2.png"){template_purchase(89,300)}


//Switches


//Graphics Switches

//Mark 2a


switch(FEAT_TRAINS, SELF, sw_mk2a_brblue_front, position_in_vehid_chain){ 0 : gfx_mk2_brblue_a_bso ; gfx_mk2_brblue_a_tso ;}
switch(FEAT_TRAINS, SELF, sw_mk2a_brblue_back, position_in_vehid_chain_from_end){ 0 : gfx_mk2_brblue_a_bso_reverse ; sw_mk2a_brblue_front ;}

switch(FEAT_TRAINS, SELF, sw_mk2a_regional_front, position_in_vehid_chain){ 0 : gfx_mk2_regional_a_bso ; gfx_mk2_regional_a_tso ;}
switch(FEAT_TRAINS, SELF, sw_mk2a_regional_back, position_in_vehid_chain_from_end){ 0 : gfx_mk2_regional_a_bso_reverse ; sw_mk2a_regional_front ;}

random_switch(FEAT_TRAINS, SELF, sw_mk2a_brblue , TRIGGER_VEHICLE_SERVICE){ 1 : sw_mk2a_brblue_back ;}
random_switch(FEAT_TRAINS, SELF, sw_mk2a_regional , TRIGGER_VEHICLE_SERVICE){ 1 : sw_mk2a_regional_back ;}

switch(FEAT_TRAINS, SELF, sw_mk2a_livery_decider, current_year){
 1967 .. 1970 : sw_mk2a_brblue ;
 1971 .. 1982 : sw_mk2a_brblue ;
 1983 .. 1995 : sw_mk2a_regional ;
 1996 .. 2004 : sw_mk2a_regional ;
 sw_mk2a_brblue ;
}


//Mark 2f


switch(FEAT_TRAINS, SELF, sw_mk2f_brblue_front, position_in_vehid_chain){ 0 : gfx_mk2_brblue_f_bso_reverse ; gfx_mk2_brblue_f_tso ;}
switch(FEAT_TRAINS, SELF, sw_mk2f_brblue_back, position_in_vehid_chain_from_end){ 0 : gfx_mk2_brblue_f_bso ; sw_mk2f_brblue_front ;}

switch(FEAT_TRAINS, SELF, sw_mk2f_intercity_front, position_in_vehid_chain){ 0 : gfx_mk2_intercity_f_bso_reverse ; gfx_mk2_intercity_f_tso ;}
switch(FEAT_TRAINS, SELF, sw_mk2f_intercity_back, position_in_vehid_chain_from_end){ 0 : gfx_mk2_intercity_f_dbso ; sw_mk2f_intercity_front ;}

switch(FEAT_TRAINS, SELF, sw_mk2f_virgin_front, position_in_vehid_chain){ 0 : gfx_mk2_virgin_f_bso_reverse ; gfx_mk2_virgin_f_tso ;}
switch(FEAT_TRAINS, SELF, sw_mk2f_virgin_back, position_in_vehid_chain_from_end){ 0 : gfx_mk2_virgin_f_bso ; sw_mk2f_virgin_front ;}

switch(FEAT_TRAINS, SELF, sw_mk2f_directrail_front, position_in_vehid_chain){ 0 : gfx_mk2_directrail_f_bso_reverse ; gfx_mk2_directrail_f_tso ;}
switch(FEAT_TRAINS, SELF, sw_mk2f_directrail_back, position_in_vehid_chain_from_end){ 0 : gfx_mk2_directrail_f_bso ; sw_mk2f_directrail_front ;}


random_switch(FEAT_TRAINS, SELF, sw_mk2f_brblue , TRIGGER_VEHICLE_SERVICE){ 1 : sw_mk2f_brblue_back ;}
random_switch(FEAT_TRAINS, SELF, sw_mk2f_intercity , TRIGGER_VEHICLE_SERVICE){ 1 : sw_mk2f_intercity_back ;}
random_switch(FEAT_TRAINS, SELF, sw_mk2f_virgin , TRIGGER_VEHICLE_SERVICE){ 1 : sw_mk2f_virgin_back ;}
random_switch(FEAT_TRAINS, SELF, sw_mk2f_directrail, TRIGGER_VEHICLE_SERVICE){ 1 : sw_mk2f_directrail_back ;}

switch(FEAT_TRAINS, SELF, sw_mk2f_livery_decider, current_year){
 1967 .. 1970 : sw_mk2f_brblue ;
 1971 .. 1982 : sw_mk2f_brblue ;
 1983 .. 1995 : sw_mk2f_intercity ;
 1996 .. 2004 : sw_mk2f_virgin ;
 2005 .. 4096 : sw_mk2f_directrail ;
 sw_mk2f_intercity ;
}


switch(FEAT_TRAINS, SELF, sw_mk2_type_decider_2, build_year){
 2005 .. 4096 : sw_mk2f_livery_decider ;
 sw_mk2a_livery_decider ;
}

switch(FEAT_TRAINS, PARENT, sw_mk2_type_decider_1, vehicle_type_id){
 87 : sw_mk2f_livery_decider ;
 sw_mk2_type_decider_2 ;
}


//Manual livery decider

switch(FEAT_TRAINS, SELF, sw_mk2_livery_decider, cargo_subtype){
 0: sw_mk2a_brblue_back ;
 1: sw_mk2f_brblue_back ;
 2: sw_mk2f_intercity_back ;
 3..4: sw_mk2a_regional_back ;
 5: sw_mk2f_virgin_back ;
 6: sw_mk2f_directrail_back ;
 sw_mk2a_brblue_back ;
}

switch(FEAT_TRAINS, SELF, sw_mk2_livery_choice_decider, livery_choice){
 1 : sw_mk2_livery_decider ;
 sw_mk2_type_decider_1 ;
}


//Sprite stacking
switch(FEAT_TRAINS, SELF, sw_mk2_default, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_mk2_livery_choice_decider;
}




//Cargo refit text
switch(FEAT_TRAINS, SELF, sw_mk2_refit_text, cargo_subtype){
 0 : return(string(STR_LIVERY_BRBLUE_SUBTYPE,string(STR_NAME_MK2A))) ;
 1 : return(string(STR_LIVERY_BRBLUE_SUBTYPE,string(STR_NAME_MK2F))) ;
 2 : string(STR_LIVERY_INTERCITY) ;
 3 : string(STR_LIVERY_REG_RAILWAYS) ;
 4 : string(STR_LIVERY_NSE) ;
 5 : string(STR_LIVERY_VIRGIN_TRAINS) ;
 6 : string(STR_LIVERY_DRS) ;
 return CB_RESULT_NO_TEXT ;
}

switch(FEAT_TRAINS, SELF, sw_mk2_refit_text_decider, livery_choice){
 1 : sw_mk2_refit_text ;
 return CB_RESULT_NO_TEXT ;
}

//Purchase sprite decider
switch(FEAT_TRAINS, SELF, sw_mk2_purchase, current_year){
 1967 .. 1970 : gfx_mk2_purchase_brblue ;
 1971 .. 1982 : gfx_mk2_purchase_brblue ;
 1983 .. 1995 : gfx_mk2_purchase_regional ;
 1996 .. 2004 : gfx_mk2_purchase_virgin ;
 2005 .. 4096 : gfx_mk2_purchase_directrail ;
 gfx_mk2_purchase_brblue ;
}


//Colour mapping

random_switch(FEAT_TRAINS, SELF, sw_mk2_brblue_colour_mapping, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;}
random_switch(FEAT_TRAINS, SELF, sw_mk2_random_sectorised_colourmapping, TRIGGER_VEHICLE_SERVICE){ 2 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_BLUE) ; 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ; }
random_switch(FEAT_TRAINS, SELF, sw_mk2_random_privatised_colourmapping){ 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_BLUE) ; 2 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ; }

switch(FEAT_TRAINS, SELF, sw_mk2_colour_mapping_auto_a, current_year){
 1967 .. 1970 : sw_mk2_brblue_colour_mapping ;
 1971 .. 1982 : sw_mk2_brblue_colour_mapping ;
 1983 .. 1995 : sw_mk2_random_sectorised_colourmapping ;
 1996 .. 2004 : sw_mk2_random_privatised_colourmapping ;
 sw_mk2_brblue_colour_mapping ;
}


random_switch(FEAT_TRAINS, SELF, sw_mk2_intercity_colour_mapping, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_GREY, COLOUR_RED) ; }
random_switch(FEAT_TRAINS, SELF, sw_mk2_virgin_colour_mapping, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_RED, COLOUR_WHITE) ; }
random_switch(FEAT_TRAINS, SELF, sw_mk2_directrail_colour_mapping, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_PALE_GREEN) ; }

switch(FEAT_TRAINS, SELF, sw_mk2_colour_mapping_auto_f, current_year){
 1967 .. 1970 : sw_mk2_brblue_colour_mapping ;
    1971 .. 1982 : sw_mk2_brblue_colour_mapping ;
    1983 .. 1995 : sw_mk2_intercity_colour_mapping ;
    1996 .. 2004 : sw_mk2_virgin_colour_mapping ;
    2005 .. 4096 : sw_mk2_directrail_colour_mapping ;
 sw_mk2_intercity_colour_mapping ;
}


switch(FEAT_TRAINS, SELF, sw_mk2_colour_mapping_auto_checker_two, build_year){
 2005 .. 4096 : sw_mk2_colour_mapping_auto_f ;
 sw_mk2_colour_mapping_auto_a ;
}

switch(FEAT_TRAINS, PARENT, sw_mk2_colour_mapping_auto_checker_one, vehicle_type_id){
 87 : sw_mk2_colour_mapping_auto_f ;
 sw_mk2_colour_mapping_auto_checker_two ;
}


switch(FEAT_TRAINS, SELF, sw_mk2_colour_mapping_manual, cargo_subtype){
 0 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;
 2 : palette_2cc(COLOUR_GREY, COLOUR_RED) ;
 3 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_BLUE) ;
 4 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ;
 5 : palette_2cc(COLOUR_RED, COLOUR_WHITE) ;
 6 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_PALE_GREEN) ;
 palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;
}

switch(FEAT_TRAINS, SELF, sw_mk2_colour_mapping_manual_check, livery_choice){
 1 : sw_mk2_colour_mapping_manual ;
 sw_mk2_colour_mapping_auto_checker_one ;
}

switch(FEAT_TRAINS, SELF, sw_mk2_colour_mapping_decider, colour_scheme_1){
 1 : sw_mk2_colour_mapping_manual_check ;
 palette_2cc(company_colour1, company_colour2) ;
}


//Item

item (FEAT_TRAINS, item_Mk2, 9020){
 property{
  name : string(STR_NAME_MK2) ;
  misc_flags : bitmask(TRAIN_FLAG_SPRITE_STACK, TRAIN_FLAG_2CC) ;
  sprite_id : SPRITE_ID_NEW_TRAIN ;
  length : 8 ;
  climates_available : ALL_CLIMATES ;
  introduction_date : date( 1963, 1, 1) ;
  model_life : 45 ;
  vehicle_life : 50 ;
  cost_factor : 65 ;
  running_cost_base : RUNNING_COST_NONE ;
  running_cost_factor : 38 ;
  refit_cost : 0 ;
  refittable_cargo_classes : CC_PASSENGERS ;
  cargo_allow_refit : [PASS, TOUR] ;
  cargo_capacity : 80 ;
  loading_speed : 20 ;
  track_type : RAIL ;
  speed : 100 mph ;
  power : 0 hp ;
  weight : 34 ton ;
 }
 graphics{
  default : sw_mk2_default ;
  purchase : sw_mk2_purchase ;
  cargo_subtype_text : sw_mk2_refit_text_decider ;
  colour_mapping : sw_mk2_colour_mapping_decider ;
 }
}
# 13 "rukts.pnml" 2
# 1 "src/WAGON/MU90.pnml" 1
spriteset(spriteset_MU90_worker_nse_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 0)}

spriteset(spriteset_MU90_worker_nse_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 25)}

spriteset(spriteset_MU90_worker_cnx_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 225)}

spriteset(spriteset_MU90_worker_cnx_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 250)}

spriteset(spriteset_MU90_worker_seb_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 225)}

spriteset(spriteset_MU90_worker_seb_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 250)}

spriteset(spriteset_MU90_worker_sey_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 450)}

spriteset(spriteset_MU90_worker_sey_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 475)}

spriteset(spriteset_MU90_worker_nse_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_purchase(259, 500)}

spriteset(spriteset_MU90_worker_cnx_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_purchase(259, 525)}

spriteset(spriteset_MU90_worker_sey_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_purchase(259, 550)}

spriteset(spriteset_MU90_worker_seb_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_purchase(259, 575)}


switch(FEAT_TRAINS, SELF, sw_MU90_passenger_livery_decider_t, current_year){
 1983 .. 1995: spriteset_MU90_worker_nse_t;
 1996 .. 2005: spriteset_MU90_worker_cnx_t;
 2006 .. 2012: spriteset_MU90_worker_sey_t;
 spriteset_MU90_worker_seb_t;
}

switch(FEAT_TRAINS, SELF, sw_MU90_purchase, current_year){
 1983 .. 1995: spriteset_MU90_worker_nse_purchase;
 1996 .. 2005: spriteset_MU90_worker_cnx_purchase;
 2006 .. 2012: spriteset_MU90_worker_sey_purchase;
 spriteset_MU90_worker_seb_purchase;
}

switch(FEAT_TRAINS, PARENT, sw_MU90_coupling_restrictions, vehicle_type_id) {
 700: return CB_RESULT_ATTACH_ALLOW;
 325: return CB_RESULT_ATTACH_ALLOW;
    return string(STR_MU90_NO_COUPLE);
}

item (FEAT_TRAINS, item_MU90, 9090) {
 property {
  name: string(STR_NAME_MU90);
  climates_available: ALL_CLIMATES;
  introduction_date: date(1990, 1, 1);
  model_life: 15;
  retire_early: 1;
  vehicle_life: 50;
  reliability_decay: 7;
  refittable_cargo_classes: CC_PASSENGERS;
  cargo_allow_refit: [PASS, TOUR, MAIL];
  loading_speed: 29;
  cost_factor: 58;
  running_cost_factor: 34;
  sprite_id: SPRITE_ID_NEW_TRAIN;
  speed: 100 mph;
  misc_flags: bitmask(TRAIN_FLAG_2CC);
  refit_cost: 0;
  track_type: RAIL;
  ai_special_flag: AI_FLAG_CARGO;
  power: 0 hp;
  running_cost_base: RUNNING_COST_NONE;
  dual_headed: 0;
  default_cargo_type: PASS;
  cargo_capacity: 80;
  weight: 40 ton;
  tractive_effort_coefficient: 0.07;
  air_drag_coefficient: 0.08;
  length: 8;
  bitmask_vehicle_info: 0;
  cargo_age_period: 185;
 }
 graphics {
 can_attach_wagon: sw_MU90_coupling_restrictions;
 default: sw_MU90_passenger_livery_decider_t;
 purchase: sw_MU90_purchase;
}
}
# 14 "rukts.pnml" 2
# 1 "src/DIESEL_LOCO/EE_Type4.pnml" 1
//Defining EE Type 4 specific template

template template_eetype4(x,y){
 //left_x, upper_y, width, height, offset_x, offset_y
 [x+0,y,8,23,-3,-10] //North
 [x+10,y,21,15,-14,-7] //North East
 [x+33,y,33,11,-17,-7] //East
 [x+69,y,21,15,-5,-7] //South East
 [x+92,y,8,23,-3,-10] //South
 [x+102,y,21,15,-14,-7] //South West
 [x+125,y,33,11,-17,-7] //West
 [x+161,y,21,15,-5,-7] //North West
}
//Reverse
template template_eetype4_reverse(x,y){
 //left_x, upper_y, width, height, offset_x, offset_y
 [x+92,y,8,23,-3,-10] //South
 [x+102,y,21,15,-14,-7] //South West
 [x+125,y,33,11,-17,-7] //West
 [x+161,y,21,15,-5,-7] //North West
 [x+0,y,8,23,-3,-10] //North
 [x+10,y,21,15,-14,-7] //North East
 [x+33,y,33,11,-17,-7] //East
 [x+69,y,21,15,-5,-7] //South East}
}

//Defining graphics
spriteset (ee40_headcode_1, "gfx/FIXTURES/class_40_hc1.png"){template_eetype4(0,0)} //Headcode 1
spriteset (ee40_headcode_2, "gfx/FIXTURES/class_40_hc2.png"){template_eetype4(0,0)} //Headcode 2
spriteset (ee40_headcode_3, "gfx/FIXTURES/class_40_hc3.png"){template_eetype4(0,0)} //Headcode 3
spriteset (ee40_headcode_4, "gfx/FIXTURES/class_40_hc4.png"){template_eetype4(0,0)} //Headcode 4
spriteset (ee40_headcode_5, "gfx/FIXTURES/class_40_hc5.png"){template_eetype4(0,0)} //Headcode 5
spriteset (ee40_br_green, "gfx/DIESEL_LOCO/class_40.png"){template_eetype4(0,0)} //BR Green
spriteset (ee40_br_green_rev, "gfx/DIESEL_LOCO/class_40.png"){template_eetype4_reverse(0,0)} //BR Green Reverse
spriteset (ee40_br_blue, "gfx/DIESEL_LOCO/class_40.png"){template_eetype4(0,25)} //BR Blue
spriteset (ee40_br_blue_rev, "gfx/DIESEL_LOCO/class_40.png"){template_eetype4_reverse(0,25)} //BR Blue Reverse
spriteset (ee40_br_blue_logo, "gfx/DIESEL_LOCO/class_40.png"){template_eetype4(0,50)} //BR Large Logo
spriteset (ee40_br_blue_logo_rev, "gfx/DIESEL_LOCO/class_40.png"){template_eetype4_reverse(0,50)} //BR Large Logo Reverse

spriteset (ee40_purchase_brgreen, "gfx/DIESEL_LOCO/class_40.png"){template_purchase_short(184,0)} //BR Green Purchase
spriteset (ee40_purchase_brblue, "gfx/DIESEL_LOCO/class_40.png"){template_purchase_short(184,0)} //BR Blue Purchase
spriteset (ee40_purchase_brblue_logo, "gfx/DIESEL_LOCO/class_40.png"){template_purchase_short(184,0)} //BR Large Logo Purchase


//Switches

//Graphics

//Automatic liveries

switch(FEAT_TRAINS, PARENT, sw_ee40_gfx_brgreen_reverse_check , vehicle_is_reversed){ 1 : ee40_br_green_rev ; ee40_br_green ; }
switch(FEAT_TRAINS, PARENT, sw_ee40_gfx_brblue_reverse_check , vehicle_is_reversed){ 1 : ee40_br_blue_rev ; ee40_br_blue ; }
switch(FEAT_TRAINS, PARENT, sw_ee40_gfx_brblue_logo_reverse_check , vehicle_is_reversed){ 1 : ee40_br_blue_logo_rev ; ee40_br_blue_logo ; }

random_switch(FEAT_TRAINS, SELF, sw_ee40_gfx_brgreen, TRIGGER_VEHICLE_SERVICE){ 1 : sw_ee40_gfx_brgreen_reverse_check ; }
random_switch(FEAT_TRAINS, SELF, sw_ee40_gfx_brblue, TRIGGER_VEHICLE_SERVICE){ 1 : sw_ee40_gfx_brblue_reverse_check ; }
random_switch(FEAT_TRAINS, SELF, sw_ee40_gfx_brblue_logo, TRIGGER_VEHICLE_SERVICE){ 1 : sw_ee40_gfx_brblue_logo_reverse_check ; }

switch(FEAT_TRAINS, SELF, sw_ee40_gfx_auto, current_year){
 1948 .. 1966 : sw_ee40_gfx_brgreen ;
 1967..1982 : sw_ee40_gfx_brblue ;
 sw_ee40_gfx_brblue_logo ;
}


//Manual liveries

switch(FEAT_TRAINS, SELF, sw_ee40_colours_manual, cargo_subtype){
 0 : sw_ee40_gfx_brgreen_reverse_check ;
 1 : sw_ee40_gfx_brblue_reverse_check ;
 sw_ee40_gfx_brblue_logo_reverse_check ;
}

switch(FEAT_TRAINS, SELF, sw_ee40_gfx_manual_check, livery_choice){
 1 : sw_ee40_colours_manual ;
 sw_ee40_gfx_auto ;
}


//Sprite stacking

random_switch(FEAT_TRAINS, SELF, sw_ee40_random_headcode, TRIGGER_VEHICLE_SERVICE){
 25 : ee40_headcode_4 ;
 25 : ee40_headcode_5 ;
 15 : ee40_headcode_1 ;
 15 : ee40_headcode_2 ;
 27 : ee40_headcode_3 ;
}

switch(FEAT_TRAINS, SELF, sw_ee40_spritestack, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : sw_ee40_gfx_manual_check ;
 1 : sw_ee40_random_headcode ;
}


//Purchase

switch(FEAT_TRAINS, SELF, sw_ee40_purchase, current_year){
 1948 .. 1966 : ee40_purchase_brgreen ;
 1967..1982 : ee40_purchase_brblue ;
 ee40_purchase_brblue_logo ;
}


//Refit text

switch(FEAT_TRAINS, SELF, sw_ee40_refit_text, cargo_subtype){
 0 : string(STR_LIVERY_BRGREEN) ;
 1 : string(STR_LIVERY_BRBLUE) ;
 2 : string(STR_LIVERY_BRBLUE_LOGO) ;
 CB_RESULT_NO_TEXT ;
}

switch(FEAT_TRAINS, SELF, sw_ee40_refit_text_check, livery_choice){
 1 : sw_ee40_refit_text ;
 CB_RESULT_NO_TEXT;
}



//Colour mapping

random_switch(FEAT_TRAINS, SELF, sw_ee40_brgreen_colours, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_DARK_GREEN, COLOUR_DARK_GREEN) ;}
random_switch(FEAT_TRAINS, SELF, sw_ee40_brblue, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_YELLOW) ;}


switch(FEAT_TRAINS, SELF, sw_ee40_colours_auto, current_year){
 1948 .. 1966 : sw_ee40_brgreen_colours ;
 sw_ee40_brblue ;
}

switch(FEAT_TRAINS, SELF, sw_ee40_recolours_manual, cargo_subtype){
 0: palette_2cc(COLOUR_DARK_GREEN, COLOUR_DARK_GREEN) ;
 palette_2cc(COLOUR_DARK_BLUE, COLOUR_YELLOW) ;
}


switch(FEAT_TRAINS, SELF, sw_ee40_colours_manual_check, livery_choice){
 1 : sw_ee40_recolours_manual ;
 sw_ee40_colours_auto ;
}

switch(FEAT_TRAINS, SELF, sw_ee40_colours_2cc_check, colour_scheme_1){
 1 : sw_ee40_colours_manual_check ;
 palette_2cc(company_colour1, COLOUR_YELLOW) ;
}


//EE Type 4 item

item (FEAT_TRAINS, item_eetype4, 40){
 property{
  name : string(STR_NAME_EETYPE4) ;
  climates_available : ALL_CLIMATES ;
  introduction_date : date(1958,1,1) ;
  refit_cost : 0 ;
  refittable_cargo_classes : 0 ;
  cargo_allow_refit : [GOOD] ;
  cargo_capacity : 1 ;
  model_life : 27 ;
  vehicle_life : 35 ;
  reliability_decay : 9 ;
  cost_factor : 60 ;
  running_cost_base : RUNNING_COST_DIESEL ;
  running_cost_factor : 200 ;
  speed : 90 mph ;
  track_type : RAIL ;
  power : 2500 hp ;
  weight : 129 ton ;
  engine_class : ENGINE_CLASS_DIESEL ;
  tractive_effort_coefficient : 0.1723880597014925 ;
  air_drag_coefficient : 0.2 ;
  length : 8 ;
  misc_flags : bitmask(TRAIN_FLAG_SPRITE_STACK, TRAIN_FLAG_2CC) ;
  effect_spawn_model_and_powered : EFFECT_SPAWN_MODEL_DIESEL ;
  sprite_id : SPRITE_ID_NEW_TRAIN ;
  dual_headed : 0 ;
 }
 graphics{
  default : sw_ee40_spritestack ;
  colour_mapping : sw_ee40_colours_2cc_check ;
  purchase : sw_ee40_purchase ;
  sound_effect : sw_sfx_diesel_loco_ee ;
  create_effect : vfx_diesel_default ;
  cargo_subtype_text : sw_ee40_refit_text_check ;
  cargo_capacity : return 0 ;
  can_attach_wagon : sw_all_but_MU90;
 }
}
# 15 "rukts.pnml" 2
# 1 "src/DIESEL_LOCO/GE_Powerhaul.pnml" 1
//GE Powerhaul

//Templates

template template_powerhaul(x, y){
 //left_x, upper_y, width, height, offset_x, offset_y
 [x+0,y,8,23,-3,-11] //North
 [x+10,y,20,16,-13,-8] //North East
 [x+32,y,33,11,-17,-7] //East
 [x+67,y,20,16,-5,-8] //South East
 [x+89,y,8,23,-3,-11] //South
 [x+99,y,20,16,-13,-8] //South West
 [x+121,y,33,11,-17,-7] //West
 [x+156,y,20,16,-5,-8] //North West
}

template template_powerhaul_reverse(x, y){
 //left_x, upper_y, width, height, offset_x, offset_y
 [x+89,y,8,23,-3,-11] //South
 [x+99,y,20,16,-13,-8] //South West
 [x+121,y,33,11,-17,-7] //West
 [x+156,y,20,16,-5,-8] //North West
 [x+0,y,8,23,-3,-11] //North
 [x+10,y,20,16,-13,-8] //North East
 [x+32,y,33,11,-17,-7] //East
 [x+67,y,20,16,-5,-8] //South East
}


//Sritesets

spriteset (gfx_powerhaul_fliner , "gfx/DIESEL_LOCO/class_70.png"){template_powerhaul(0,25)}
spriteset (gfx_powerhaul_fliner_reverse , "gfx/DIESEL_LOCO/class_70.png"){template_powerhaul_reverse(0,25)}
spriteset (gfx_powerhaul_colas , "gfx/DIESEL_LOCO/class_70.png"){template_powerhaul(0,0)}
spriteset (gfx_powerhaul_colas_reverse , "gfx/DIESEL_LOCO/class_70.png"){template_powerhaul_reverse(0,0)}

spriteset (gfx_powerhaul_headlights , "gfx/FIXTURES/class_70_lights.png"){template_powerhaul(0,0)}
spriteset (gfx_powerhaul_taillights , "gfx/FIXTURES/class_70_lights.png"){template_powerhaul(0,25)}

spriteset (gfx_powerhaul_fliner_purchase , "gfx/DIESEL_LOCO/class_70.png"){template_purchase_short(178,25)}
spriteset (gfx_powerhaul_colas_purchase , "gfx/DIESEL_LOCO/class_70.png"){template_purchase_short(178,0)}


//Graphics

switch(FEAT_TRAINS, PARENT, sw_powerhaul_gfx_fliner_reverse_check, vehicle_is_reversed){ 1 : gfx_powerhaul_fliner_reverse ; gfx_powerhaul_fliner ; }
switch(FEAT_TRAINS, PARENT, sw_powerhaul_gfx_colas_reverse_check, vehicle_is_reversed){ 1 : gfx_powerhaul_colas_reverse ; gfx_powerhaul_colas ; }

//Automatic
/*

switch(FEAT_TRAINS, PARENT, sw_powerhaul_gfx_auto_decider, bitmask_consist_info){

	CC_PIECE_GOODS : sw_powerhaul_gfx_fliner_reverse_check ;

	CC_OVERSIZED   : sw_powerhaul_gfx_fliner_reverse_check ;

	CC_PASSENGERS  : sw_powerhaul_gfx_fliner_reverse_check ;

	sw_powerhaul_gfx_colas_reverse_check ;

}

*/
# 58 "src/DIESEL_LOCO/GE_Powerhaul.pnml"
switch(FEAT_TRAINS, SELF, sw_powerhaul_gfx_auto, build_year){
 2008..2014 : sw_powerhaul_gfx_fliner_reverse_check ;
 sw_powerhaul_gfx_colas_reverse_check ;
}


//Manual

switch(FEAT_TRAINS, SELF, sw_powerhaul_gfx_manual, cargo_subtype){
 0 : sw_powerhaul_gfx_fliner_reverse_check ;
 sw_powerhaul_gfx_colas_reverse_check ;
}


switch(FEAT_TRAINS, SELF, sw_powerhaul_gfx_manual_check, livery_choice){
 1 : sw_powerhaul_gfx_manual ;
 sw_powerhaul_gfx_auto ;
}


//Spritestacking

switch(FEAT_TRAINS, SELF, sw_powerhaul_headlights, position_in_consist){ 0 : gfx_powerhaul_headlights;}
switch(FEAT_TRAINS, SELF, sw_powerhaul_taillights, position_in_consist_from_end){ 0 : gfx_powerhaul_taillights;}

switch(FEAT_TRAINS, SELF, sw_powerhaul_spritestack, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : sw_powerhaul_gfx_manual_check ;
 1 : sw_powerhaul_headlights ;
 2 : sw_powerhaul_taillights ;
}


//Refit text

switch(FEAT_TRAINS, SELF, sw_powerhaul_refit_text, cargo_subtype){
 0 : string(STR_LIVERY_FREIGHTLINER_POWERHAUL) ;
 1 : string(STR_LIVERY_COLAS) ;
 CB_RESULT_NO_TEXT ;
}


switch(FEAT_TRAINS, SELF, sw_powerhaul_refit_text_check, livery_choice){
 1 : sw_powerhaul_refit_text ;
 CB_RESULT_NO_TEXT ;
}


//Purchase

switch(FEAT_TRAINS, SELF, sw_powerhaul_purchase, current_year){
 2008..2014 : gfx_powerhaul_fliner_purchase ;
 gfx_powerhaul_colas_purchase ;
}


//Colour mapping
/*

switch(FEAT_TRAINS, PARENT, sw_powerhaul_colours_auto_decider, bitmask_consist_info){

	CC_PIECE_GOODS : palette_2cc(COLOUR_DARK_GREEN, COLOUR_YELLOW) ;

	CC_OVERSIZED : palette_2cc(COLOUR_DARK_GREEN, COLOUR_YELLOW) ;

	CC_PASSENGERS : palette_2cc(COLOUR_DARK_GREEN, COLOUR_YELLOW) ;

	palette_2cc(COLOUR_YELLOW, COLOUR_ORANGE) ;

}

*/
# 122 "src/DIESEL_LOCO/GE_Powerhaul.pnml"
switch(FEAT_TRAINS, SELF, sw_powerhaul_colours_auto, build_year){
 2008..2014 : palette_2cc(COLOUR_DARK_GREEN, COLOUR_YELLOW) ;
 palette_2cc(COLOUR_YELLOW, COLOUR_ORANGE) ;
}

switch(FEAT_TRAINS, SELF, sw_powerhaul_colours_manual, cargo_subtype){
 0 : palette_2cc(COLOUR_DARK_GREEN, COLOUR_YELLOW) ;
 palette_2cc(COLOUR_YELLOW, COLOUR_ORANGE) ;
}


switch(FEAT_TRAINS, SELF, sw_powerhaul_colours_manual_check, livery_choice){
 1 : sw_powerhaul_colours_manual ;
 sw_powerhaul_colours_auto ;
}

switch(FEAT_TRAINS, SELF, sw_powerhaul_colours_2cc_check, colour_scheme_1){
 1 : sw_powerhaul_colours_manual_check ;
 palette_2cc(company_colour1, COLOUR_YELLOW) ;
}


//item

item(FEAT_TRAINS, item_powerhaul, 70){
 property{
  name : string(STR_NAME_POWERHAUL) ;
  misc_flags : bitmask(TRAIN_FLAG_SPRITE_STACK, TRAIN_FLAG_2CC) ;
  sprite_id : SPRITE_ID_NEW_TRAIN ;
  length : 8 ;
  climates_available : ALL_CLIMATES ;
  introduction_date : date(2009,11,28) ;
  model_life : VEHICLE_NEVER_EXPIRES ;
  vehicle_life : 30 ;
  reliability_decay : 5 ;
  cost_factor : 75 ;
  running_cost_base : RUNNING_COST_ELECTRIC ;
  running_cost_factor : 255 ;
  refit_cost : 0 ;
  refittable_cargo_classes : 0 ;
  cargo_allow_refit : [GOOD] ;
  cargo_capacity : 1 ;
  track_type : RAIL ;
  engine_class : ENGINE_CLASS_DIESEL ;
  speed : 75 mph ;
  power : 3690 hp ;
  weight : 129 ton ;
  tractive_effort_coefficient : 0.4217054263565891 ;
  air_drag_coefficient : 0.1066666666666667 ;
  effect_spawn_model_and_powered : EFFECT_SPAWN_MODEL_DIESEL ;
  dual_headed : 0 ;
 }
 graphics{
  default : sw_powerhaul_spritestack ;
  purchase : sw_powerhaul_purchase ;
  sound_effect : sw_sfx_diesel_loco_modern ;
  create_effect : vfx_diesel_default ;
  colour_mapping : sw_powerhaul_colours_2cc_check ;
  cargo_subtype_text : sw_powerhaul_refit_text_check ;
  cargo_capacity : return 0 ;
  can_attach_wagon : sw_all_but_MU90;
 }
}
# 16 "rukts.pnml" 2
# 1 "src/DIESEL_LOCO/UKLight.pnml" 1
//UK Light

//Spritesets

spriteset (gfx_ulight_drs , "gfx/DIESEL_LOCO/class_68.png"){template_uklight(0,0)}
spriteset (gfx_ulight_drs_reverse , "gfx/DIESEL_LOCO/class_68.png"){template_uklight_reverse(0,0)}
spriteset (gfx_ulight_tpe , "gfx/DIESEL_LOCO/class_68.png"){template_uklight(0,26)}
spriteset (gfx_ulight_tpe_reverse , "gfx/DIESEL_LOCO/class_68.png"){template_uklight_reverse(0,26)}

spriteset (gfx_uklight_headlight , "gfx/FIXTURES/uklight_headlight.png"){template_uklight(0,0)}

spriteset (gfx_uklight_drs_purchase, "gfx/DIESEL_LOCO/class_68.png"){template_purchase(176, 0)}
spriteset (gfx_uklight_tpe_purchase, "gfx/DIESEL_LOCO/class_68.png"){template_purchase(176, 26)}

//Graphics

switch(FEAT_TRAINS, PARENT, sw_uklight_gfx_drs_reverse_check, vehicle_is_reversed){ 1 : gfx_ulight_drs_reverse ; gfx_ulight_drs ; }
switch(FEAT_TRAINS, PARENT, sw_uklight_gfx_tpe_reverse_check, vehicle_is_reversed){ 1 : gfx_ulight_tpe_reverse ; gfx_ulight_tpe ; }


//Automatic

switch(FEAT_TRAINS, SELF, sw_uklight_gfx_passenger_check, most_common_refit){
 PASS : sw_uklight_gfx_tpe_reverse_check ;
 sw_uklight_gfx_drs_reverse_check ;
}

switch(FEAT_TRAINS, SELF, sw_uklight_gfx_auto, build_year){
 2013..2018 : sw_uklight_gfx_drs_reverse_check ;
 sw_uklight_gfx_passenger_check ;
}


//Manual

switch(FEAT_TRAINS, SELF, sw_uklight_gfx_manual, cargo_subtype){
 1 : sw_uklight_gfx_tpe_reverse_check ;
 sw_uklight_gfx_drs_reverse_check ;
}


switch(FEAT_TRAINS, SELF, sw_uklight_gfx_manual_check, livery_choice){
 1 : sw_uklight_gfx_manual ;
 sw_uklight_gfx_auto ;
}


//Spritestacking

switch(FEAT_TRAINS, SELF, sw_uklight_gfx_headlights, position_in_consist){
 0 : gfx_uklight_headlight ;
}

switch(FEAT_TRAINS, SELF, sw_uklight_spritestack, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : sw_uklight_gfx_manual_check ;
 1 : sw_uklight_gfx_headlights ;
}


//Purchase

switch(FEAT_TRAINS, SELF, sw_uklight_purchase, current_year){
 2013..2018 : gfx_uklight_drs_purchase ;
 gfx_uklight_tpe_purchase ;
}


//Refit text

switch(FEAT_TRAINS, SELF, sw_uklight_refit_text, cargo_subtype){
 0 : string(STR_LIVERY_DRS) ;
 1 : string(STR_LIVERY_TPE_NEW) ;
 CB_RESULT_NO_TEXT ;
}

switch(FEAT_TRAINS, SELF, sw_uklight_refit_text_check, livery_choice){
 1 : sw_uklight_refit_text ;
 CB_RESULT_NO_TEXT ;
}


//Colour mapping

switch(FEAT_TRAINS, SELF, sw_uklight_colours_passenger_decider, most_common_refit){
 PASS : palette_2cc(COLOUR_DARK_BLUE, COLOUR_PINK) ;
 palette_2cc(COLOUR_DARK_BLUE, COLOUR_PALE_GREEN) ;
}

switch(FEAT_TRAINS, SELF, sw_uklight_colours_auto, build_year){
 2013..2018 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_PALE_GREEN) ;
 sw_uklight_colours_passenger_decider ;
}

switch(FEAT_TRAINS, SELF, sw_uklight_colours_manual, cargo_subtype){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_PINK) ;
 palette_2cc(COLOUR_DARK_BLUE, COLOUR_PALE_GREEN);
}


switch(FEAT_TRAINS, SELF, sw_uklight_colours_manual_check, livery_choice){
 1 : sw_uklight_colours_manual ;
 sw_uklight_colours_auto ;
}


switch(FEAT_TRAINS, SELF, sw_uklight_colours_2cc_check, colour_scheme_1){
 1 : sw_uklight_colours_manual_check ;
 palette_2cc(company_colour1, company_colour2) ;
}


//Item

item (FEAT_TRAINS, item_uklight, 68){
 property{
  name : string(STR_NAME_UKLIGHT) ;
  misc_flags : bitmask(TRAIN_FLAG_SPRITE_STACK, TRAIN_FLAG_2CC) ;
  sprite_id : SPRITE_ID_NEW_TRAIN ;
  length : 8 ;
  climates_available : ALL_CLIMATES ;
  introduction_date : date(2014, 1, 1) ;
  model_life : VEHICLE_NEVER_EXPIRES ;
  vehicle_life : 35 ;
  reliability_decay : 7 ;
  cost_factor : 42 ;
  running_cost_base : RUNNING_COST_ELECTRIC ;
  running_cost_factor : 240 ;
  refit_cost : 0 ;
  refittable_cargo_classes : 0 ;
  cargo_allow_refit : [GOOD] ;
  cargo_capacity : 1 ;
  track_type : RAIL ;
  engine_class : ENGINE_CLASS_DIESEL ;
  speed : 100 mph ;
  power : 3800 hp ;
  weight : 85 ton ;
  tractive_effort_coefficient : 0.3729411764705882 ;
  air_drag_coefficient : 0.08 ;
  effect_spawn_model_and_powered : EFFECT_SPAWN_MODEL_DIESEL ;
  dual_headed : 0 ;
 }
 graphics{
  default : sw_uklight_spritestack ;
  purchase : sw_uklight_purchase ;
  colour_mapping : sw_uklight_colours_2cc_check ;
  sound_effect : sw_sfx_diesel_loco_modern ;
  create_effect : vfx_diesel_default ;
  cargo_subtype_text : sw_uklight_refit_text_check ;
  cargo_capacity : return 0 ;
  can_attach_wagon : sw_all_but_MU90;
 }
}
# 17 "rukts.pnml" 2
# 1 "src/ELECTRIC_LOCO/BR_Class87.pnml" 1
//Class 87

//Spritesets

spriteset(gfx_br87_brblue , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double(0,0)}
spriteset(gfx_br87_brblue_reverse , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double_reverse(0,0)}
spriteset(gfx_br87_intercity , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double(0,25)}
spriteset(gfx_br87_intercity_reverse , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double_reverse(0,25)}
spriteset(gfx_br87_virgin , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double(0,50)}
spriteset(gfx_br87_virgin_reverse , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double_reverse(0,50)}
spriteset(gfx_br87_calsleeper , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double(0,75)}
spriteset(gfx_br87_calsleeper_reverse , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double_reverse(0,75)}
spriteset(gfx_br87_gbrf , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double(0,100)}
spriteset(gfx_br87_gbrf_reverse , "gfx/ELECTRIC_LOCO/class_87.png"){template_Mk2_double_reverse(0,100)}

spriteset(gfx_br87_brblue_purchase , "gfx/ELECTRIC_LOCO/class_87.png"){template_purchase(178,0)}
spriteset(gfx_br87_intercity_purchase , "gfx/ELECTRIC_LOCO/class_87.png"){template_purchase(178,25)}
spriteset(gfx_br87_virgin_purchase , "gfx/ELECTRIC_LOCO/class_87.png"){template_purchase(178,50)}
spriteset(gfx_br87_calsleeper_purchase , "gfx/ELECTRIC_LOCO/class_87.png"){template_purchase(178,75)}

spriteset(gfx_br87_headlight , "gfx/FIXTURES/class_87_headlights.png"){template_Mk2_double(0,0)}
spriteset(gfx_br87_taillight , "gfx/FIXTURES/class_87_headlights.png"){template_Mk2_double(0,25)}

//Switches

//Graphics

switch(FEAT_TRAINS, PARENT, sw_br87_gfx_brblue_reverse_check , vehicle_is_reversed){ 1 : gfx_br87_brblue_reverse ; gfx_br87_brblue ;}
switch(FEAT_TRAINS, PARENT, sw_br87_gfx_intercity_reverse_check , vehicle_is_reversed){ 1 : gfx_br87_intercity_reverse ; gfx_br87_intercity ;}
switch(FEAT_TRAINS, PARENT, sw_br87_gfx_virgin_reverse_check , vehicle_is_reversed){ 1 : gfx_br87_virgin_reverse ; gfx_br87_virgin ;}
switch(FEAT_TRAINS, PARENT, sw_br87_gfx_calsleeper_reverse_check , vehicle_is_reversed){ 1 : gfx_br87_calsleeper_reverse ; gfx_br87_calsleeper ;}
switch(FEAT_TRAINS, PARENT, sw_br87_gfx_gbrf_reverse_check , vehicle_is_reversed){ 1 : gfx_br87_gbrf_reverse ; gfx_br87_gbrf ;}

random_switch(FEAT_TRAINS, SELF, sw_br87_gfx_brblue , TRIGGER_VEHICLE_SERVICE){ 1 : sw_br87_gfx_brblue_reverse_check ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_gfx_intercity , TRIGGER_VEHICLE_SERVICE){ 1 : sw_br87_gfx_intercity_reverse_check ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_gfx_virgin , TRIGGER_VEHICLE_SERVICE){ 1 : sw_br87_gfx_virgin_reverse_check ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_gfx_calsleeper , TRIGGER_VEHICLE_SERVICE){ 1 : sw_br87_gfx_calsleeper_reverse_check ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_gfx_gbrf , TRIGGER_VEHICLE_SERVICE){ 1 : sw_br87_gfx_gbrf_reverse_check ;}

//Automatic liveries

switch(FEAT_TRAINS, SELF, sw_br87_gfx_privatised, most_common_refit){
 CC_PASSENGERS : sw_br87_gfx_calsleeper ;
 sw_br87_gfx_gbrf ;
}

switch(FEAT_TRAINS, SELF, sw_br87_gfx_auto, current_year){
 1971 .. 1982 : sw_br87_gfx_brblue ;
 1983 .. 1995 : sw_br87_gfx_intercity ;
 1996 .. 2004 : sw_br87_gfx_virgin ;
 2005 .. 4096 : sw_br87_gfx_privatised ;
 sw_br87_gfx_virgin ;
}

//Manual liveries

switch(FEAT_TRAINS, SELF, sw_br87_gfx_manual, cargo_subtype){
 0 : sw_br87_gfx_brblue_reverse_check ;
 1 : sw_br87_gfx_intercity_reverse_check ;
 2 : sw_br87_gfx_virgin_reverse_check ;
 3 : sw_br87_gfx_calsleeper_reverse_check ;
 4 : sw_br87_gfx_gbrf_reverse_check ;
 sw_br87_gfx_virgin_reverse_check ;
}


switch(FEAT_TRAINS, SELF, sw_br87_gfx_manual_check, livery_choice){
 1 : sw_br87_gfx_manual ;
 sw_br87_gfx_auto ;
}


//Sprite stacking

switch(FEAT_TRAINS, SELF, sw_br87_taillight_decider, position_in_consist_from_end){
 0 : gfx_br87_taillight ;
}

switch(FEAT_TRAINS, SELF, sw_br87_headlight_decider, position_in_consist){
 0 : gfx_br87_headlight ;
}

switch(FEAT_TRAINS, SELF, sw_br87_sprite_stack, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : sw_br87_gfx_manual_check ;
 1 : sw_br87_headlight_decider ;
 2 : sw_br87_taillight_decider ;
}


//Cargo refit text

switch(FEAT_TRAINS, SELF, sw_br87_refit_text, cargo_subtype){
 0 : string(STR_LIVERY_BRBLUE) ;
 1 : string(STR_LIVERY_INTERCITY) ;
 2 : string(STR_LIVERY_VIRGIN_TRAINS) ;
 3 : string(STR_LIVERY_CAL_SLEEPER) ;
 4 : string(STR_LIVERY_GBRF) ;
 CB_RESULT_NO_TEXT ;
}

switch(FEAT_TRAINS, SELF, sw_br87_refit_text_checker, livery_choice){
 1 : sw_br87_refit_text ;
 CB_RESULT_NO_TEXT ;
}


//Purchase sprite

switch(FEAT_TRAINS, SELF, sw_br87_purchase, current_year){
 1971 .. 1982 : gfx_br87_brblue_purchase ;
 1983 .. 1995 : gfx_br87_intercity_purchase ;
 1996 .. 2004 : gfx_br87_virgin_purchase ;
 2005 .. 4096 : gfx_br87_calsleeper_purchase ;
 gfx_br87_virgin_purchase ;
}

//Colour mapping


random_switch(FEAT_TRAINS, SELF, sw_br87_brblue_colours, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_sectorised_colours, TRIGGER_VEHICLE_SERVICE){ 3 : palette_2cc(COLOUR_GREY, COLOUR_RED) ; 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_virgin_colours, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_RED, COLOUR_WHITE) ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_calsleeper_colours, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;}
random_switch(FEAT_TRAINS, SELF, sw_br87_gbrf_colours, TRIGGER_VEHICLE_SERVICE){ 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_ORANGE) ;}

switch(FEAT_TRAINS, SELF, sw_br87_privatised_colours, most_common_refit){
 CC_PASSENGERS: sw_br87_calsleeper_colours ;
 sw_br87_gbrf_colours ;
}

switch(FEAT_TRAINS, SELF, sw_br87_colours_auto, current_year){
 1971 .. 1982 : sw_br87_brblue_colours ;
 1983 .. 1995 : sw_br87_sectorised_colours ;
 1996 .. 2004 : sw_br87_virgin_colours ;
 2005 .. 4096 : sw_br87_privatised_colours ;
 sw_br87_virgin_colours ;
}

switch(FEAT_TRAINS, SELF, sw_br87_colours_manual, cargo_subtype){
 0 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;
 1 : palette_2cc(COLOUR_GREY, COLOUR_RED) ;
 2 : palette_2cc(COLOUR_RED, COLOUR_WHITE) ;
 3 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;
 4 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_ORANGE) ;
 palette_2cc(COLOUR_RED, COLOUR_WHITE) ;
}

switch(FEAT_TRAINS, SELF, sw_br87_colours_manual_check, livery_choice){
 1 : sw_br87_colours_manual ;
 sw_br87_colours_auto ;
}

switch(FEAT_TRAINS, SELF, sw_br87_colours_2cc_check, colour_scheme_1){
 1 : sw_br87_colours_manual_check ;
 palette_2cc(company_colour1, company_colour2) ;
}


//Item


item (FEAT_TRAINS, item_br87, 87){
 property{
  name : string(STR_NAME_87) ;
  misc_flags : bitmask(TRAIN_FLAG_SPRITE_STACK, TRAIN_FLAG_2CC);
  sprite_id : SPRITE_ID_NEW_TRAIN ;
  length : 8 ;
  climates_available : ALL_CLIMATES ;
  introduction_date : date(1972,1,1) ;
  model_life : 28 ;
  vehicle_life : 40 ;
  reliability_decay : 7 ;
  cost_factor : 55 ;
  running_cost_base : RUNNING_COST_ELECTRIC ;
  running_cost_factor : 250 ;
  refit_cost : 0 ;
  refittable_cargo_classes : 0 ;
  cargo_allow_refit : [GOOD] ;
  cargo_capacity : 1 ;
  track_type : ELRL ;
  engine_class : ENGINE_CLASS_ELECTRIC ;
  speed : 110 mph ;
  power : 5000 hp ;
  weight : 83 ton ;
  tractive_effort_coefficient : 0.3108433734939759 ;
  air_drag_coefficient : 0.0727272727272727 ;
  effect_spawn_model_and_powered : EFFECT_SPAWN_MODEL_ELECTRIC ;
  dual_headed : 0 ;
 }
 graphics{
  default : sw_br87_sprite_stack ;
  purchase : sw_br87_purchase ;
  sound_effect : sw_sfx_electric_loco_old ;
  create_effect : vfx_ohle ;
  colour_mapping : sw_br87_colours_2cc_check ;
  cargo_subtype_text : sw_br87_refit_text_checker ;
  cargo_capacity : return 0 ;
  can_attach_wagon : sw_all_but_MU90;
 }
}
# 18 "rukts.pnml" 2
# 1 "src/ELECTRIC_LOCO/EuroDual.pnml" 1
//Class 88

//Spritesets

spriteset(gfx_eurodual_drs , "gfx/ELECTRIC_LOCO/class_88.png"){template_uklight(0,0)}
spriteset(gfx_eurodual_drs_reverse , "gfx/ELECTRIC_LOCO/class_88.png"){template_uklight_reverse(0,0)}

spriteset(gfx_eurodual_drs_purchase, "gfx/ELECTRIC_LOCO/class_88.png"){template_purchase_short(176,0)}


switch(FEAT_TRAINS, PARENT, sw_eurodual_gfx_drs_reversal_check, vehicle_is_reversed){
 1 : gfx_eurodual_drs_reverse ;
 gfx_eurodual_drs ;
}

switch(FEAT_TRAINS, SELF, sw_eurodual_spritestack, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : sw_eurodual_gfx_drs_reversal_check ;
 1 : sw_uklight_gfx_headlights ;
}



//Colour mapping

switch(FEAT_TRAINS, SELF, sw_eurodual_colours, colour_scheme_1){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_PALE_GREEN) ;
 palette_2cc(company_colour1, company_colour2) ;
}


//Effects deciders

switch(FEAT_TRAINS, PARENT, sw_eurodual_sfx_decider, current_railtype){
 ELRL : sw_sfx_electric_loco_modern ;
 sw_sfx_diesel_loco_modern ;
}

switch(FEAT_TRAINS, PARENT, sw_eurodual_effect_decider, current_railtype){
 ELRL : vfx_ohle ;
 vfx_diesel_default ;
}



//Item

item (FEAT_TRAINS, item_eurodual, 88){
 property{
  name : string(STR_NAME_EURODUAL) ;
  misc_flags : bitmask(TRAIN_FLAG_SPRITE_STACK, TRAIN_FLAG_2CC) ;
  sprite_id : SPRITE_ID_NEW_TRAIN ;
  length : 8 ;
  climates_available : ALL_CLIMATES ;
  introduction_date : date(2016, 7, 1) ;
  model_life : VEHICLE_NEVER_EXPIRES ;
  vehicle_life : 35 ;
  reliability_decay : 9 ;
  cost_factor : 46 ;
  running_cost_base : RUNNING_COST_ELECTRIC ;
  running_cost_factor : 250 ;
  refit_cost : 0 ;
  refittable_cargo_classes : 0 ;
  cargo_allow_refit : [GOOD] ;
  cargo_capacity : 1 ;
  track_type : RAIL ;
  engine_class : ENGINE_CLASS_DIESEL ;
  speed : 100 mph ;
  power : 5364 hp ;
  weight : 86 ton ;
  tractive_effort_coefficient : 0.3686046511627907 ;
  air_drag_coefficient : 0.08 ;
  effect_spawn_model_and_powered : EFFECT_SPAWN_MODEL_ELECTRIC ;
  dual_headed : 0 ;
 }
 graphics{
  default : sw_eurodual_spritestack ;
  purchase : gfx_eurodual_drs_purchase ;
  colour_mapping : sw_eurodual_colours ;
  sound_effect : sw_eurodual_sfx_decider ;
  create_effect : sw_eurodual_effect_decider ;
  cargo_capacity : return 0 ;
  power: (current_railtype == ELRL) ? 5364 : 986;
  can_attach_wagon : sw_all_but_MU90;
 }
}
# 19 "rukts.pnml" 2
# 1 "src/DMU/class_142.pnml" 1
spriteset(spriteset_142_t_rr, "gfx/DMU/class_142.png") {template_7_4(0, 168)}
spriteset(spriteset_142_f_rr, "gfx/DMU/class_142.png") {template_7_8(0, 96)}
spriteset(spriteset_142_r_rr, "gfx/DMU/class_142.png") {template_7_8(0, 120)}
spriteset(spriteset_142_o_rr, "gfx/DMU/class_142.png") {template_7_8(0, 144)}

spriteset(spriteset_142_t_n_spirit, "gfx/DMU/class_142.png") {template_7_4(163, 72)}
spriteset(spriteset_142_f_n_spirit, "gfx/DMU/class_142.png") {template_7_8(163, 0)}
spriteset(spriteset_142_r_n_spirit, "gfx/DMU/class_142.png") {template_7_8(163, 24)}
spriteset(spriteset_142_o_n_spirit, "gfx/DMU/class_142.png") {template_7_8(163, 48)}

spriteset(spriteset_142_t_northern, "gfx/DMU/class_142.png") {template_7_4(163, 168)}
spriteset(spriteset_142_f_northern, "gfx/DMU/class_142.png") {template_7_8(163, 96)}
spriteset(spriteset_142_r_northern, "gfx/DMU/class_142.png") {template_7_8(163, 120)}
spriteset(spriteset_142_o_northern, "gfx/DMU/class_142.png") {template_7_8(163, 144)}

spriteset(spriteset_140_t, "gfx/DMU/class_142.png") {template_7_4(0, 264)}
spriteset(spriteset_140_f, "gfx/DMU/class_142.png") {template_7_8(0, 192)}
spriteset(spriteset_140_r, "gfx/DMU/class_142.png") {template_7_8(0, 216)}
spriteset(spriteset_140_o, "gfx/DMU/class_142.png") {template_7_8(0, 240)}

//Purchase Sprites
spriteset(spriteset_140_purchase, "gfx/DMU/class_142.png") {template_dualhead_purchase(247, 195)}
spriteset(spriteset_142_rr_purchase, "gfx/DMU/class_142.png") {template_dualhead_purchase(247, 208)}
spriteset(spriteset_142_n_spirit_purchase, "gfx/DMU/class_142.png") {template_dualhead_purchase(247, 221)}
spriteset(spriteset_142_northern_purchase, "gfx/DMU/class_142.png") {template_dualhead_purchase(247, 234)}

//Switches

//Power Car

switch(FEAT_TRAINS, SELF, sw_140_f, position_in_consist){
 0: spriteset_140_f;
 spriteset_140_o;
}switch(FEAT_TRAINS, SELF, sw_140_select, position_in_consist_from_end){
 0: spriteset_140_r;
 sw_140_f;
}random_switch(FEAT_TRAINS, SELF, sw_140, TRIGGER_VEHICLE_SERVICE){
 1: sw_140_select;}

switch(FEAT_TRAINS, SELF, sw_142_rr_f, position_in_consist){
 0: spriteset_142_f_rr;
 spriteset_142_o_rr;
}switch(FEAT_TRAINS, SELF, sw_142_rr_select, position_in_consist_from_end){
 0: spriteset_142_r_rr;
 sw_142_rr_f;
}random_switch(FEAT_TRAINS, SELF, sw_142_rr, TRIGGER_VEHICLE_SERVICE){
 1: sw_142_rr_select;}

switch(FEAT_TRAINS, SELF, sw_142_n_spirit_f, position_in_consist){
 0: spriteset_142_f_n_spirit;
 spriteset_142_o_n_spirit;
}switch(FEAT_TRAINS, SELF, sw_142_n_spirit_select, position_in_consist_from_end){
 0: spriteset_142_r_n_spirit;
 sw_142_n_spirit_f;
}random_switch(FEAT_TRAINS, SELF, sw_142_n_spirit, TRIGGER_VEHICLE_SERVICE){
 1: sw_142_n_spirit_select;}

switch(FEAT_TRAINS, SELF, sw_142_northern_f, position_in_consist){
 0: spriteset_142_f_northern;
 spriteset_142_o_northern;
}switch(FEAT_TRAINS, SELF, sw_142_northern_select, position_in_consist_from_end){
 0: spriteset_142_r_northern;
 sw_142_northern_f;
}random_switch(FEAT_TRAINS, SELF, sw_142_northern, TRIGGER_VEHICLE_SERVICE){
 1: sw_142_northern_select;}

//Trailer/Pan

random_switch(FEAT_TRAINS, SELF, sw_140_t, TRIGGER_VEHICLE_SERVICE){
 1: spriteset_140_t;}

random_switch(FEAT_TRAINS, SELF, sw_142_rr_t, TRIGGER_VEHICLE_SERVICE){
 1: spriteset_142_t_rr;}

random_switch(FEAT_TRAINS, SELF, sw_142_n_spirit_t, TRIGGER_VEHICLE_SERVICE){
 1: spriteset_142_t_n_spirit;}

random_switch(FEAT_TRAINS, SELF, sw_142_northern_t, TRIGGER_VEHICLE_SERVICE){
 1: spriteset_142_t_northern;}

//Livery Switches 

switch(FEAT_TRAINS, SELF, sw_142_passenger_livery_decider_a, current_year){
 1983 .. 1995: sw_142_rr;
 1996 .. 2004: sw_142_n_spirit;
 2005 .. 4096: sw_142_northern;
 sw_142_northern;
}

switch(FEAT_TRAINS, SELF, sw_142_passenger_livery_decider, build_year){
 0 .. 1985: sw_140;
 1986 .. 3000: sw_142_passenger_livery_decider_a;
}

switch(FEAT_TRAINS, SELF, sw_142_passenger_livery_decider_a_t, current_year){
 1983 .. 1995: sw_142_rr_t;
 1996 .. 2004: sw_142_n_spirit_t;
 2005 .. 4096: sw_142_northern_t;
 sw_142_northern_t;
}

switch(FEAT_TRAINS, PARENT, sw_142_passenger_livery_decider_t, build_year){
 0 .. 1985: sw_140_t;
 1986 .. 3000: sw_142_passenger_livery_decider_a_t;
}

//Manual liveries

switch(FEAT_TRAINS, SELF, sw_142_manual_livery_decider_a, cargo_subtype){
 0: sw_142_rr;
 1: sw_142_n_spirit;
 2: sw_142_northern;
}

switch(FEAT_TRAINS, SELF, sw_142_manual_livery_decider, build_year){
 0 .. 1985: sw_140;
 1986 .. 3000: sw_142_manual_livery_decider_a;
}

switch(FEAT_TRAINS, SELF, sw_142_manual_livery_decider_a_t, cargo_subtype){
 0: sw_142_rr_t;
 1: sw_142_n_spirit_t;
 2: sw_142_northern_t;
}

switch(FEAT_TRAINS, PARENT, sw_142_manual_livery_decider_t, build_year){
 0 .. 1985: sw_140_t;
 sw_142_manual_livery_decider_a_t;
}

switch(FEAT_TRAINS, SELF, sw_142_livery_choice_decider, livery_choice){
 1 : sw_142_manual_livery_decider ;
 sw_142_passenger_livery_decider ;
}

switch(FEAT_TRAINS, SELF, sw_142_livery_choice_decider_t, livery_choice){
 1 : sw_142_manual_livery_decider_t ;
 sw_142_passenger_livery_decider_t ;
}

//Refit text

switch(FEAT_TRAINS, SELF, sw_142_refit_text_a, cargo_subtype){
 0: string(STR_LIVERY_REG_RAILWAYS);
 1: string(STR_LIVERY_N_SPIRIT);
 2: string(STR_LIVERY_NORTHERN);
 return CB_RESULT_NO_TEXT;
}

switch(FEAT_TRAINS, PARENT, sw_142_refit_text, build_year){
 0 .. 1985: return CB_RESULT_NO_TEXT ;
 sw_142_refit_text_a ;
}

switch(FEAT_TRAINS, SELF, sw_142_refit_text_decider, livery_choice){
 1 : sw_142_refit_text ;
 return CB_RESULT_NO_TEXT ;
}

//Purchase sprite decider
switch(FEAT_TRAINS, SELF, sw_142_purchase, current_year){
 0 .. 1985: spriteset_140_purchase;
 1983 .. 1995: spriteset_142_rr_purchase;
 1996 .. 2004: spriteset_142_n_spirit_purchase;
 spriteset_142_northern_purchase;
}

switch(FEAT_TRAINS, SELF, sw_142_default, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_142_livery_choice_decider;
}

switch(FEAT_TRAINS, SELF, sw_142_default_t, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_142_livery_choice_decider_t;
}

//Recolour

random_switch(FEAT_TRAINS, SELF, sw_142_rr_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1: palette_2cc(COLOUR_DARK_BLUE, COLOUR_BLUE) ;
}

random_switch(FEAT_TRAINS, SELF, sw_142_n_spirit_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_BLUE, COLOUR_GREEN) ;
}

random_switch(FEAT_TRAINS, SELF, sw_142_northern_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1: palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;
}

random_switch(FEAT_TRAINS, SELF, sw_140_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_RED, company_colour2) ;
}

//Recolour Switches

switch(FEAT_TRAINS, SELF, sw_142_colour_mapping_auto_a, current_year){
 1983 .. 1995: sw_142_rr_colour_mapping;
 1996 .. 2004: sw_142_n_spirit_colour_mapping;
 sw_142_northern_colour_mapping;
}

switch(FEAT_TRAINS, SELF, sw_142_colour_mapping_auto, build_year){
 0 .. 1985: sw_140_colour_mapping ;
 sw_142_colour_mapping_auto_a ;
}

switch(FEAT_TRAINS, SELF, sw_142_colour_mapping_manual_a, cargo_subtype){
 0: sw_142_rr_colour_mapping;
 1: sw_142_n_spirit_colour_mapping;
 2: sw_142_northern_colour_mapping;
 return CB_RESULT_NO_TEXT;
}

switch(FEAT_TRAINS, PARENT, sw_142_colour_mapping_manual, build_year){
 0 .. 1985: sw_140_colour_mapping ;
 sw_142_colour_mapping_manual_a ;
}

switch(FEAT_TRAINS, PARENT, sw_142_colour_mapping_manual_check, livery_choice){
 1 : sw_142_colour_mapping_manual ;
 sw_142_colour_mapping_auto ;
}

switch(FEAT_TRAINS, PARENT, sw_142_colour_mapping_decider, colour_scheme_1){
 1 : sw_142_colour_mapping_manual_check ;
 palette_2cc(company_colour1, company_colour2) ;
}

switch(FEAT_TRAINS, SELF, sw_142_coupling_restrictions, vehicle_type_id) {
    9020: return CB_RESULT_ATTACH_ALLOW;
 142: return CB_RESULT_ATTACH_ALLOW;
    return string(STR_142_NO_COUPLE);
}

item (FEAT_TRAINS, item_142, 142) {
 property {
  name: string(STR_NAME_142);
  climates_available: ALL_CLIMATES;
  introduction_date: date(1985, 1, 1);
  model_life: 30;
  retire_early: 1;
  vehicle_life: 50;
  reliability_decay: 7;
  refittable_cargo_classes: bitmask(CC_PASSENGERS);
  cargo_allow_refit: [PASS, TOUR];
  loading_speed: 27;
  cost_factor: 20;
  running_cost_factor: 15;
  sprite_id: SPRITE_ID_NEW_TRAIN;
  speed: 75 mph;
  misc_flags: bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_2CC);
  refit_cost: 0;
  track_type: RAIL;
  ai_special_flag: AI_FLAG_CARGO;
  power: 225 hp;
  running_cost_base: RUNNING_COST_DIESEL;
  dual_headed: 1;
  default_cargo_type: PASS;
  cargo_capacity: 55;
  weight: 25 ton;
  tractive_effort_coefficient: 0.35;
  air_drag_coefficient: 0.05;
  length: 7;
  effect_spawn_model_and_powered: EFFECT_SPAWN_MODEL_DIESEL;
  bitmask_vehicle_info: 0;
  cargo_age_period: 150;
  default_cargo_type: PASS;
 }
 graphics {
 can_attach_wagon: sw_142_coupling_restrictions;
 default: sw_142_default;
 purchase: sw_142_purchase;
 create_effect: vfx_diesel_default;
 cargo_subtype_text: sw_142_refit_text_decider ;
 colour_mapping: sw_142_colour_mapping_decider;
 sound_effect: sw_sfx_dmu_one;
}
  livery_override (9020) {
  cargo_capacity: 60;
  default: sw_142_default_t;
  colour_mapping: sw_142_colour_mapping_decider;
  cargo_subtype_text: sw_142_refit_text_decider ;
  length: 7;
  weight: 25;
}
}
# 20 "rukts.pnml" 2
//#include "src/EMU/PEP.pnml"
//#include "src/EMU/class_317.pnml"
# 1 "src/EMU/class_325.pnml" 1
spriteset(spriteset_x65_nse_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 0)}

spriteset(spriteset_x65_nse_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 25)}

spriteset(spriteset_x65_nse_f, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 150)}

spriteset(spriteset_x65_nse_r, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 175)}

spriteset(spriteset_x65_nse_o, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 200)}

spriteset(spriteset_x65_cnx_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 225)}

spriteset(spriteset_x65_cnx_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 250)}

spriteset(spriteset_x65_cnx_f, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 375)}

spriteset(spriteset_x65_cnx_r, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 400)}

spriteset(spriteset_x65_cnx_o, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 425)}

spriteset(spriteset_x65_seb_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 225)}

spriteset(spriteset_x65_seb_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 250)}

spriteset(spriteset_x65_seb_f, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 375)}

spriteset(spriteset_x65_seb_r, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 400)}

spriteset(spriteset_x65_seb_o, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 425)}

spriteset(spriteset_x65_sey_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 450)}

spriteset(spriteset_x65_sey_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 475)}

spriteset(spriteset_x65_sey_f, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 600)}

spriteset(spriteset_x65_sey_r, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 625)}

spriteset(spriteset_x65_sey_o, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(0, 650)}

spriteset(spriteset_325_t, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 450)}

spriteset(spriteset_325_p, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 475)}

spriteset(spriteset_325_f, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 600)}

spriteset(spriteset_325_r, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 625)}

spriteset(spriteset_325_o, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker(179, 650)}

//Reverse Pans

spriteset(spriteset_x65_nse_pr, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker_reverse(0, 25)}

spriteset(spriteset_x65_cnx_pr, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker_reverse(0, 250)}

spriteset(spriteset_x65_seb_pr, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker_reverse(179, 250)}

spriteset(spriteset_x65_sey_pr, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker_reverse(0, 475)}

spriteset(spriteset_325_pr, "gfx/UNUSED & MIXED/networkers.png") {template_8_8_networker_reverse(179, 475)}

//Purchase Sprites
spriteset(spriteset_325_nse_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_dualhead_purchase(179, 500)}

spriteset(spriteset_325_cnx_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_dualhead_purchase(179, 525)}

spriteset(spriteset_325_seb_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_dualhead_purchase(179, 550)}

spriteset(spriteset_325_sey_purchase, "gfx/UNUSED & MIXED/networkers.png") {template_dualhead_purchase(179, 575)}

//Switches

//trailer vfx

switch(FEAT_TRAINS, SELF, sw_325_t_vfx_f, position_in_vehid_chain){
 0: vfx_ohle_only;
 return 0;
}

switch(FEAT_TRAINS, SELF, sw_325_t_vfx_r, position_in_vehid_chain_from_end){
 0: vfx_ohle_only;
 return 0;
}

switch(FEAT_TRAINS, SELF, sw_325_t_vfx, vehicle_is_reversed){
 0: sw_325_t_vfx_f;
 1: sw_325_t_vfx_r;
}

//Coupling

switch(FEAT_TRAINS, SELF, sw_325_coupling_restrictions, vehicle_type_id) {
    item_MU90: return CB_RESULT_ATTACH_ALLOW;
 item_325: return CB_RESULT_ATTACH_ALLOW;
    return string(STR_325_NO_COUPLE);
}

//Power Car
 switch(FEAT_TRAINS, SELF, sw_325_nse_f, position_in_consist){
 0: spriteset_x65_nse_f;
 spriteset_x65_nse_o;
 }

 switch(FEAT_TRAINS, SELF, sw_325_nse, position_in_consist_from_end){
 0: spriteset_x65_nse_r;
 sw_325_nse_f;
 }

 switch(FEAT_TRAINS, SELF, sw_325_cnx_f, position_in_consist){
 0: spriteset_x65_cnx_f;
 spriteset_x65_cnx_o;
 }

 switch(FEAT_TRAINS, SELF, sw_325_cnx, position_in_consist_from_end){
 0: spriteset_x65_cnx_r;
 sw_325_cnx_f;
 }

 switch(FEAT_TRAINS, SELF, sw_325_seb_f, position_in_consist){
 0: spriteset_x65_seb_f;
 spriteset_x65_seb_o;
 }

 switch(FEAT_TRAINS, SELF, sw_325_seb, position_in_consist_from_end){
 0: spriteset_x65_seb_r;
 sw_325_seb_f;
 }

 switch(FEAT_TRAINS, SELF, sw_325_sey_f, position_in_consist){
 0: spriteset_x65_sey_f;
 spriteset_x65_sey_o;
 }

 switch(FEAT_TRAINS, SELF, sw_325_sey, position_in_consist_from_end){
 0: spriteset_x65_sey_r;
 sw_325_sey_f;
 }


//Trailer/Pan

switch(FEAT_TRAINS, SELF, sw_325_nse_t, position_in_vehid_chain){
 0: spriteset_x65_nse_p;
 spriteset_x65_nse_t;
 }

 switch(FEAT_TRAINS, SELF, sw_325_cnx_t, position_in_vehid_chain){
 0: spriteset_x65_cnx_p;
 spriteset_x65_cnx_t;
 }

switch(FEAT_TRAINS, SELF, sw_325_seb_t, position_in_vehid_chain){
 0: spriteset_x65_seb_p;
 spriteset_x65_seb_t;
 }

switch(FEAT_TRAINS, SELF, sw_325_sey_t, position_in_vehid_chain){
 0: spriteset_x65_sey_p;
 spriteset_x65_sey_t;
 }

//Trailer/Pan reverse 

switch(FEAT_TRAINS, SELF, sw_325_nse_t_re, position_in_vehid_chain_from_end){
 0: spriteset_x65_nse_pr;
 spriteset_x65_nse_t;
 }

 switch(FEAT_TRAINS, SELF, sw_325_cnx_t_re, position_in_vehid_chain_from_end){
 0: spriteset_x65_cnx_pr;
 spriteset_x65_cnx_t;
 }

switch(FEAT_TRAINS, SELF, sw_325_seb_t_re, position_in_vehid_chain_from_end){
 0: spriteset_x65_seb_pr;
 spriteset_x65_seb_t;
 }

switch(FEAT_TRAINS, SELF, sw_325_sey_t_re, position_in_vehid_chain_from_end){
 0: spriteset_x65_sey_pr;
 spriteset_x65_sey_t;
 }

//Mail

switch(FEAT_TRAINS, SELF, sw_325_t_f, position_in_vehid_chain){
 0: spriteset_325_p;
 spriteset_325_t;
 }

 switch(FEAT_TRAINS, SELF, sw_325_t_re, position_in_vehid_chain){
 0: spriteset_325_pr;
 spriteset_325_t;
 }

 switch(FEAT_TRAINS, SELF, sw_325_t, vehicle_is_reversed){
 0: sw_325_t_f;
 1: sw_325_t_re;
}

 switch(FEAT_TRAINS, SELF, sw_325_f, position_in_consist){
 0: spriteset_325_f;
 spriteset_325_o;
 }

 switch(FEAT_TRAINS, SELF, sw_325, position_in_consist_from_end){
 0: spriteset_325_r;
 sw_325_f;
 }

//NSE or CNX random_switch

random_switch(FEAT_TRAINS, PARENT, sw_325_cnx_nse){
 8 : sw_325_cnx;
 1 : sw_325_nse;
}

random_switch(FEAT_TRAINS, PARENT, sw_325_cnx_nse_t){
 dependent : sw_325_cnx_nse;
 8 : sw_325_cnx_t;
 1 : sw_325_nse_t;
}

random_switch(FEAT_TRAINS, PARENT, sw_325_cnx_nse_t_re){
 dependent : sw_325_cnx_nse;
 8 : sw_325_cnx_t_re;
 1 : sw_325_nse_t_re;
}

//Livery Application Switches

random_switch(FEAT_TRAINS, SELF, sw_325_nse_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_nse ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_cnx_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_cnx_nse ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_sey_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_sey ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_seb_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_seb ;
 }

  random_switch(FEAT_TRAINS, SELF, sw_325_mail_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325 ;
 }

//And for the trailers

random_switch(FEAT_TRAINS, SELF, sw_325_nse_t_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_nse_t ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_cnx_t_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_cnx_nse_t ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_sey_t_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_sey_t ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_seb_t_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_seb_t ;
 }

  random_switch(FEAT_TRAINS, SELF, sw_325_mail_t_f_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_t ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_nse_t_re_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_nse_t_re ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_cnx_t_re_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_cnx_nse_t_re ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_sey_t_re_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_sey_t_re ;
 }

 random_switch(FEAT_TRAINS, SELF, sw_325_seb_t_re_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_seb_t_re ;
 }

  random_switch(FEAT_TRAINS, SELF, sw_325_mail_t_re_select, TRIGGER_VEHICLE_SERVICE){
 1: return sw_325_t_re ;
 }

//Livery Switches 

switch(FEAT_TRAINS, SELF, sw_325_passenger_livery_decider, current_year){
 1983 .. 1995: sw_325_nse_select;
 1996 .. 2005: sw_325_cnx_select;
 2006 .. 2012: sw_325_sey_select;
 sw_325_seb_select;
}

switch(FEAT_TRAINS, SELF, sw_325_passenger_livery_decider_t_f, current_year){
 1983 .. 1995: sw_325_nse_t_select;
 1996 .. 2005: sw_325_cnx_t_select;
 2006 .. 2012: sw_325_sey_t_select;
 sw_325_seb_t_select;
}

switch(FEAT_TRAINS, SELF, sw_325_passenger_livery_decider_t_re, current_year){
 1983 .. 1995: sw_325_nse_t_re_select;
 1996 .. 2005: sw_325_cnx_t_re_select;
 2006 .. 2012: sw_325_sey_t_re_select;
 sw_325_seb_t_re_select;
}

switch(FEAT_TRAINS, SELF, sw_325_passenger_livery_decider_t, vehicle_is_reversed){
 0: sw_325_passenger_livery_decider_t_f;
 1: sw_325_passenger_livery_decider_t_re;
}

switch(FEAT_TRAINS, SELF, sw_325_t_select, vehicle_is_reversed){
 0: sw_325_mail_t_f_select;
 1: sw_325_mail_t_re_select;
}

 switch(FEAT_TRAINS, SELF, sw_325_livery_decider, cargo_classes){
 CC_PASSENGERS: sw_325_passenger_livery_decider;
 CC_MAIL: sw_325_passenger_livery_decider;
 sw_325_mail_select;
}

 switch(FEAT_TRAINS, PARENT, sw_325_livery_decider_t, cargo_classes){
 CC_PASSENGERS: sw_325_passenger_livery_decider_t;
 CC_MAIL: sw_325_passenger_livery_decider_t;
 sw_325_t_select;
}

//Manual liveries

switch(FEAT_TRAINS, SELF, sw_325_manual_livery_decider, cargo_subtype){
 0: sw_325_nse_select;
 1: sw_325_cnx_select;
 2: sw_325_sey_select;
 3: sw_325_seb_select;
}

 switch(FEAT_TRAINS, SELF, sw_325_manual_livery_decider_b, cargo_classes){
 CC_PASSENGERS: sw_325_manual_livery_decider;
 CC_MAIL: sw_325_manual_livery_decider;
 sw_325_mail_select;
}

switch(FEAT_TRAINS, SELF, sw_325_manual_livery_decider_t, cargo_subtype){
 0: sw_325_nse_t_select;
 1: sw_325_cnx_t_select;
 2: sw_325_sey_t_select;
 3: sw_325_seb_t_select;
}

switch(FEAT_TRAINS, SELF, sw_325_manual_livery_decider_t_re, cargo_subtype){
 0: sw_325_nse_t_re_select;
 1: sw_325_cnx_t_re_select;
 2: sw_325_sey_t_re_select;
 3: sw_325_seb_t_re_select;
}

 switch(FEAT_TRAINS, SELF, sw_325_manual_livery_decider_t_b, cargo_classes){
 CC_PASSENGERS: sw_325_manual_livery_decider_t;
 CC_MAIL: sw_325_manual_livery_decider_t;
 sw_325_mail_t_f_select;
}

 switch(FEAT_TRAINS, SELF, sw_325_manual_livery_decider_t_re_b, cargo_classes){
 CC_PASSENGERS: sw_325_manual_livery_decider_t_re;
 CC_MAIL: sw_325_manual_livery_decider_t_re;
 sw_325_mail_t_re_select;
}

 switch(FEAT_TRAINS, SELF, sw_325_manual_livery_decider_t_c, vehicle_is_reversed){
 0: sw_325_manual_livery_decider_t_b;
 1: sw_325_manual_livery_decider_t_re_b;
}

switch(FEAT_TRAINS, SELF, sw_325_livery_choice_decider, livery_choice){
 1 : sw_325_manual_livery_decider_b ;
 sw_325_livery_decider ;
}

switch(FEAT_TRAINS, SELF, sw_325_livery_choice_decider_t, livery_choice){
 1 : sw_325_manual_livery_decider_t_c ;
 sw_325_livery_decider_t ;
}

//Refit text

switch(FEAT_TRAINS, SELF, sw_325_refit_text, cargo_subtype){
 0: return string(STR_LIVERY_NSE);
 1: return string(STR_LIVERY_CONNEX);
 2: return string(STR_LIVERY_SE_YELLOW);
 3: return string(STR_LIVERY_SE_BLUE);
 return CB_RESULT_NO_TEXT ;
}

//Refit text

switch(FEAT_TRAINS, SELF, sw_325_refit_text_b, cargo_classes){
 CC_PASSENGERS: sw_325_refit_text;
 CC_MAIL: sw_325_refit_text;
 return CB_RESULT_NO_TEXT ;
}

switch(FEAT_TRAINS, SELF, sw_325_refit_text_decider, livery_choice){
 1 : sw_325_refit_text_b ;
 return CB_RESULT_NO_TEXT ;
}

//Purchase sprite decider
switch(FEAT_TRAINS, SELF, sw_325_purchase, current_year){
 1983 .. 1995: spriteset_325_nse_purchase;
 1996 .. 2005: spriteset_325_cnx_purchase;
 2006 .. 2012: spriteset_325_sey_purchase;
 spriteset_325_seb_purchase;
}

switch(FEAT_TRAINS, SELF, sw_325_default, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_325_livery_choice_decider;
}

switch(FEAT_TRAINS, SELF, sw_325_default_t, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_325_livery_choice_decider_t;
}

//Recolour

random_switch(FEAT_TRAINS, SELF, sw_325_nse_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1: palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ;
 }

random_switch(FEAT_TRAINS, SELF, sw_325_cnx_a_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_YELLOW) ;
}

random_switch(FEAT_TRAINS, SELF, sw_325_south_eastern_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_YELLOW);
}

random_switch(FEAT_TRAINS, SELF, sw_325_mail_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_RED, COLOUR_YELLOW);
}

random_switch(FEAT_TRAINS, PARENT, sw_325_cnx_colour_mapping){
 dependent : sw_325_cnx_nse;
 5 : sw_325_cnx_a_colour_mapping;
 2 : sw_325_nse_colour_mapping;
}

//Recolour Switches

switch(FEAT_TRAINS, PARENT, sw_325_colour_mapping_auto_pass, current_year){
 1983 .. 1995 : sw_325_nse_colour_mapping ;
 1996 .. 2005 : sw_325_cnx_colour_mapping ;
 sw_325_south_eastern_colour_mapping;
}

switch(FEAT_TRAINS, PARENT, sw_325_colour_mapping_auto, cargo_classes){
 CC_PASSENGERS: sw_325_colour_mapping_auto_pass;
 CC_MAIL: sw_325_colour_mapping_auto_pass;
 sw_325_mail_colour_mapping;
}

switch(FEAT_TRAINS, PARENT, sw_325_colour_mapping_manual_pass, cargo_subtype){
 0 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ;
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_YELLOW) ;
 2..3 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_YELLOW);
}

switch(FEAT_TRAINS, PARENT, sw_325_colour_mapping_manual, cargo_classes){
 CC_PASSENGERS: sw_325_colour_mapping_manual_pass;
 CC_MAIL: sw_325_colour_mapping_manual_pass;
 sw_325_mail_colour_mapping ;
}

switch(FEAT_TRAINS, PARENT, sw_325_colour_mapping_manual_check, livery_choice){
 1 : sw_325_colour_mapping_manual ;
 sw_325_colour_mapping_auto ;
}

switch(FEAT_TRAINS, PARENT, sw_325_colour_mapping_decider, colour_scheme_1){
 1 : sw_325_colour_mapping_manual_check ;
 palette_2cc(company_colour1, company_colour2) ;
}

item (FEAT_TRAINS, item_325, 325) {
 property {
  name: string(STR_NAME_325);
  climates_available: ALL_CLIMATES;
  introduction_date: date(1990, 1, 1);
  model_life: 30;
  retire_early: 1;
  vehicle_life: 50;
  reliability_decay: 7;
  refittable_cargo_classes: bitmask(CC_PASSENGERS, CC_MAIL, CC_ARMOURED);
  cargo_allow_refit: [PASS, TOUR, MAIL, VALU, GOLD, DIAM];
  loading_speed: 35;
  cost_factor: 55;
  running_cost_factor: 45;
  sprite_id: SPRITE_ID_NEW_TRAIN;
  speed: 100 mph;
  misc_flags: bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_2CC);
  refit_cost: 0;
  track_type: SAAZ;
  ai_special_flag: AI_FLAG_CARGO;
  power: 1500 hp;
  running_cost_base: RUNNING_COST_ELECTRIC;
  dual_headed: 1;
  default_cargo_type: PASS;
  cargo_capacity: 105;
  weight: 40 ton;
  engine_class: ENGINE_CLASS_ELECTRIC;
  tractive_effort_coefficient: 0.4;
  air_drag_coefficient: 0.1;
  length: 8;
  effect_spawn_model_and_powered: EFFECT_SPAWN_MODEL_ELECTRIC;
  bitmask_vehicle_info: 0;
  cargo_age_period: 185;
  default_cargo_type: PASS;
 }
 graphics {
 can_attach_wagon: sw_325_coupling_restrictions;
 default: sw_325_default;
 purchase: sw_325_purchase;
 create_effect: vfx_3rd_only;
 cargo_subtype_text: sw_325_refit_text_decider ;
 colour_mapping: sw_325_colour_mapping_decider ;
 sound_effect: sw_sfx_electric_loco_modern;
}
  livery_override (item_MU90) {
  cargo_capacity: 110;
  default: sw_325_default_t;
  colour_mapping: sw_325_colour_mapping_decider;
  create_effect: sw_325_t_vfx;
  cargo_subtype_text: sw_325_refit_text_decider ;
}
}
# 23 "rukts.pnml" 2
# 1 "src/EMU/class_411.pnml" 1
spriteset(spriteset_411_t_green, "gfx/EMU/class_411.png") {template_8_8_networker(0, 0)}

spriteset(spriteset_411_f_green, "gfx/EMU/class_411.png") {template_8_8_networker(0, 75)}

spriteset(spriteset_411_r_green, "gfx/EMU/class_411.png") {template_8_8_networker(0, 100)}

spriteset(spriteset_411_o_green, "gfx/EMU/class_411.png") {template_8_8_networker(0, 125)}

spriteset(spriteset_411_t_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 0)}

spriteset(spriteset_421_msb_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 50)}

spriteset(spriteset_411_f_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 75)}

spriteset(spriteset_411_r_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 100)}

spriteset(spriteset_411_o_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 125)}

spriteset(spriteset_421_f_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 150)}

spriteset(spriteset_421_r_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 175)}

spriteset(spriteset_421_o_blue_grey, "gfx/EMU/class_411.png") {template_8_8_networker(179, 200)}

spriteset(spriteset_411_t_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 0)}

spriteset(spriteset_421_msb_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 50)}

spriteset(spriteset_411_f_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 75)}

spriteset(spriteset_411_r_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 100)}

spriteset(spriteset_411_o_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 125)}

spriteset(spriteset_421_f_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 150)}

spriteset(spriteset_421_r_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 175)}

spriteset(spriteset_421_o_nse, "gfx/EMU/class_411.png") {template_8_8_networker(537, 200)}

spriteset(spriteset_411_t_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 0)}

spriteset(spriteset_421_msb_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 50)}

spriteset(spriteset_411_f_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 75)}

spriteset(spriteset_411_r_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 100)}

spriteset(spriteset_411_o_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 125)}

spriteset(spriteset_421_f_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 150)}

spriteset(spriteset_421_r_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 175)}

spriteset(spriteset_421_o_swt, "gfx/EMU/class_411.png") {template_8_8_networker(716, 200)}

spriteset(spriteset_411_t_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 0)}

spriteset(spriteset_421_msb_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 50)}

spriteset(spriteset_411_f_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 75)}

spriteset(spriteset_411_r_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 100)}

spriteset(spriteset_411_o_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 125)}

spriteset(spriteset_421_f_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 150)}

spriteset(spriteset_421_r_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 175)}

spriteset(spriteset_421_o_cnx, "gfx/EMU/class_411.png") {template_8_8_networker(895, 200)}

spriteset(spriteset_411_t_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 0)}

spriteset(spriteset_421_msb_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 50)}

spriteset(spriteset_411_f_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 75)}

spriteset(spriteset_411_r_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 100)}

spriteset(spriteset_411_o_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 125)}

spriteset(spriteset_421_f_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 150)}

spriteset(spriteset_421_r_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 175)}

spriteset(spriteset_421_o_heritage, "gfx/EMU/class_411.png") {template_8_8_networker(1074, 200)}


//Reverse MSBs

spriteset(spriteset_421_msb_blue_grey_r, "gfx/EMU/class_411.png") {template_8_8_networker_reverse(179, 50)}

spriteset(spriteset_421_msb_nse_r, "gfx/EMU/class_411.png") {template_8_8_networker_reverse(537, 50)}

spriteset(spriteset_421_msb_swt_r, "gfx/EMU/class_411.png") {template_8_8_networker_reverse(716, 50)}

spriteset(spriteset_421_msb_cnx_r, "gfx/EMU/class_411.png") {template_8_8_networker_reverse(895, 50)}

spriteset(spriteset_421_msb_heritage_r, "gfx/EMU/class_411.png") {template_8_8_networker_reverse(1074, 50)}

//Purchase Sprites
spriteset(spriteset_411_green_purchase, "gfx/EMU/class_411.png") {template_dualhead_purchase(0, 150)}

spriteset(spriteset_411_blue_grey_purchase, "gfx/EMU/class_411.png") {template_dualhead_purchase(0, 163)}

spriteset(spriteset_411_nse_purchase, "gfx/EMU/class_411.png") {template_dualhead_purchase(0, 176)}

spriteset(spriteset_411_swt_purchase, "gfx/EMU/class_411.png") {template_dualhead_purchase(0, 189)}

spriteset(spriteset_411_cnx_purchase, "gfx/EMU/class_411.png") {template_dualhead_purchase(0, 202)}

spriteset(spriteset_411_heritage_purchase, "gfx/EMU/class_411.png") {template_dualhead_purchase(0, 215)}

//Switches

//Power Car
switch(FEAT_TRAINS, SELF, sw_411_green_f, position_in_consist){
 0: spriteset_411_f_green;
 spriteset_411_o_green;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_green_select, position_in_consist_from_end){
 0: spriteset_411_r_green;
 sw_411_green_f;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_green, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_green_select;}

switch(FEAT_TRAINS, SELF, sw_411_blue_grey_f, position_in_consist){
 0: spriteset_411_f_blue_grey;
 spriteset_411_o_blue_grey;
}switch(FEAT_TRAINS, SELF, sw_411_blue_grey, position_in_consist_from_end){
 0: spriteset_411_r_blue_grey;
 sw_411_blue_grey_f;
}switch(FEAT_TRAINS, SELF, sw_421_blue_grey_f, position_in_consist){
 0: spriteset_421_f_blue_grey;
 spriteset_421_o_blue_grey;
}switch(FEAT_TRAINS, SELF, sw_421_blue_grey, position_in_consist_from_end){
 0: spriteset_421_r_blue_grey;
 sw_421_blue_grey_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_blue_grey_select, build_year){
 0 .. 1963: sw_411_blue_grey;
 sw_421_blue_grey;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_blue_grey, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_blue_grey_select;}

switch(FEAT_TRAINS, SELF, sw_411_nse_f, position_in_consist){
 0: spriteset_411_f_nse;
 spriteset_411_o_nse;
}switch(FEAT_TRAINS, SELF, sw_411_nse, position_in_consist_from_end){
 0: spriteset_411_r_nse;
 sw_411_nse_f;
}switch(FEAT_TRAINS, SELF, sw_421_nse_f, position_in_consist){
 0: spriteset_421_f_nse;
 spriteset_421_o_nse;
}switch(FEAT_TRAINS, SELF, sw_421_nse, position_in_consist_from_end){
 0: spriteset_421_r_nse;
 sw_421_nse_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_nse_select, build_year){
 0 .. 1963: sw_411_nse;
 sw_421_nse;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_nse, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_nse_select;}

switch(FEAT_TRAINS, SELF, sw_411_swt_f, position_in_consist){
 0: spriteset_411_f_swt;
 spriteset_411_o_swt;
}switch(FEAT_TRAINS, SELF, sw_411_swt, position_in_consist_from_end){
 0: spriteset_411_r_swt;
 sw_411_swt_f;
}switch(FEAT_TRAINS, SELF, sw_421_swt_f, position_in_consist){
 0: spriteset_421_f_swt;
 spriteset_421_o_swt;
}switch(FEAT_TRAINS, SELF, sw_421_swt, position_in_consist_from_end){
 0: spriteset_421_r_swt;
 sw_421_swt_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_swt_select, build_year){
 0 .. 1963: sw_411_swt;
 sw_421_swt;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_swt, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_swt_select;}

switch(FEAT_TRAINS, SELF, sw_411_cnx_f, position_in_consist){
 0: spriteset_411_f_cnx;
 spriteset_411_o_cnx;
}switch(FEAT_TRAINS, SELF, sw_411_cnx, position_in_consist_from_end){
 0: spriteset_411_r_cnx;
 sw_411_cnx_f;
}switch(FEAT_TRAINS, SELF, sw_421_cnx_f, position_in_consist){
 0: spriteset_421_f_cnx;
 spriteset_421_o_cnx;
}switch(FEAT_TRAINS, SELF, sw_421_cnx, position_in_consist_from_end){
 0: spriteset_421_r_cnx;
 sw_421_cnx_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_cnx_select, build_year){
 0 .. 1963: sw_411_cnx;
 sw_421_cnx;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_cnx, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_cnx_select;}

switch(FEAT_TRAINS, SELF, sw_411_heritage_f, position_in_consist){
 0: spriteset_411_f_heritage;
 spriteset_411_o_heritage;
}switch(FEAT_TRAINS, SELF, sw_411_heritage, position_in_consist_from_end){
 0: spriteset_411_r_heritage;
 sw_411_heritage_f;
}switch(FEAT_TRAINS, SELF, sw_421_heritage_f, position_in_consist){
 0: spriteset_421_f_heritage;
 spriteset_421_o_heritage;
}switch(FEAT_TRAINS, SELF, sw_421_heritage, position_in_consist_from_end){
 0: spriteset_421_r_heritage;
 sw_421_heritage_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_heritage_select, build_year){
 0 .. 1963: sw_411_heritage;
 sw_421_heritage;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_heritage, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_heritage_select;}


//Trailer/Pan

random_switch(FEAT_TRAINS, SELF, sw_southern_slam_green_t, TRIGGER_VEHICLE_SERVICE){
 1: spriteset_411_t_green;}

switch(FEAT_TRAINS, SELF, sw_421_blue_grey_msb_f, position_in_vehid_chain){
 0: spriteset_421_msb_blue_grey;
 spriteset_411_t_blue_grey;
}switch(FEAT_TRAINS, SELF, sw_421_blue_grey_msb_r, position_in_vehid_chain_from_end){
 0: spriteset_421_msb_blue_grey_r;
 spriteset_411_t_blue_grey;
}switch(FEAT_TRAINS, SELF, sw_421_blue_grey_t, vehicle_is_reversed){
 0: sw_421_blue_grey_msb_r;
 sw_421_blue_grey_msb_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_blue_grey_select_t, build_year){
 0 .. 1963: spriteset_411_t_blue_grey;
 sw_421_blue_grey_t;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_blue_grey_t, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_blue_grey_select_t;}

switch(FEAT_TRAINS, SELF, sw_421_nse_msb_f, position_in_vehid_chain){
 0: spriteset_421_msb_nse;
 spriteset_411_t_nse;
}switch(FEAT_TRAINS, SELF, sw_421_nse_msb_r, position_in_vehid_chain_from_end){
 0: spriteset_421_msb_nse_r;
 spriteset_411_t_nse;
}switch(FEAT_TRAINS, SELF, sw_421_nse_t, vehicle_is_reversed){
 0: sw_421_nse_msb_r;
 sw_421_nse_msb_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_nse_select_t, build_year){
 0 .. 1963: spriteset_411_t_nse;
 sw_421_nse_t;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_nse_t, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_nse_select_t;}

switch(FEAT_TRAINS, SELF, sw_421_swt_msb_f, position_in_vehid_chain){
 0: spriteset_421_msb_swt;
 spriteset_411_t_swt;
}switch(FEAT_TRAINS, SELF, sw_421_swt_msb_r, position_in_vehid_chain_from_end){
 0: spriteset_421_msb_swt_r;
 spriteset_411_t_swt;
}switch(FEAT_TRAINS, SELF, sw_421_swt_t, vehicle_is_reversed){
 0: sw_421_swt_msb_r;
 sw_421_swt_msb_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_swt_select_t, build_year){
 0 .. 1963: spriteset_411_t_swt;
 sw_421_swt_t;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_swt_t, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_swt_select_t;}

switch(FEAT_TRAINS, SELF, sw_421_cnx_msb_f, position_in_vehid_chain){
 0: spriteset_421_msb_cnx;
 spriteset_411_t_cnx;
}switch(FEAT_TRAINS, SELF, sw_421_cnx_msb_r, position_in_vehid_chain_from_end){
 0: spriteset_421_msb_cnx_r;
 spriteset_411_t_cnx;
}switch(FEAT_TRAINS, SELF, sw_421_cnx_t, vehicle_is_reversed){
 0: sw_421_cnx_msb_r;
 sw_421_cnx_msb_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_cnx_select_t, build_year){
 0 .. 1963: spriteset_411_t_cnx;
 sw_421_cnx_t;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_cnx_t, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_cnx_select_t;}

switch(FEAT_TRAINS, SELF, sw_421_heritage_msb_f, position_in_vehid_chain){
 0: spriteset_421_msb_heritage;
 spriteset_411_t_heritage;
}switch(FEAT_TRAINS, SELF, sw_421_heritage_msb_r, position_in_vehid_chain_from_end){
 0: spriteset_421_msb_heritage_r;
 spriteset_411_t_heritage;
}switch(FEAT_TRAINS, SELF, sw_421_heritage_t, vehicle_is_reversed){
 0: sw_421_heritage_msb_r;
 sw_421_heritage_msb_f;
}switch(FEAT_TRAINS, SELF, sw_southern_slam_heritage_select_t, build_year){
 0 .. 1963: spriteset_411_t_heritage;
 sw_421_heritage_t;
}random_switch(FEAT_TRAINS, SELF, sw_southern_slam_heritage_t, TRIGGER_VEHICLE_SERVICE){
 1: sw_southern_slam_heritage_select_t;}

//Livery Switches 

switch(FEAT_TRAINS, SELF, sw_411_passenger_livery_decider, current_year){
 0 .. 1963: sw_southern_slam_green;
 1964 .. 1982: sw_southern_slam_blue_grey;
 1983 .. 1995: sw_southern_slam_nse;
 1996 .. 2004: sw_southern_slam_swt;
 2005 .. 2008: sw_southern_slam_cnx;
 sw_southern_slam_heritage;
}

switch(FEAT_TRAINS, SELF, sw_411_passenger_livery_decider_t, current_year){
 0 .. 1963: sw_southern_slam_green_t;
 1964 .. 1982: sw_southern_slam_blue_grey_t;
 1983 .. 1995: sw_southern_slam_nse_t;
 1996 .. 2004: sw_southern_slam_swt_t;
 2005 .. 2008: sw_southern_slam_cnx_t;
 sw_southern_slam_heritage_t;
}

//Manual liveries

switch(FEAT_TRAINS, SELF, sw_411_manual_livery_decider, cargo_subtype){
 0: sw_southern_slam_green;
 1: sw_southern_slam_blue_grey;
 2: sw_southern_slam_nse;
 3: sw_southern_slam_swt;
 4: sw_southern_slam_cnx;
 5: sw_southern_slam_heritage;
}

switch(FEAT_TRAINS, SELF, sw_411_manual_livery_decider_t, cargo_subtype){
 0: sw_southern_slam_green_t;
 1: sw_southern_slam_blue_grey_t;
 2: sw_southern_slam_nse_t;
 3: sw_southern_slam_swt_t;
 4: sw_southern_slam_cnx_t;
 5: sw_southern_slam_heritage_t;
}

switch(FEAT_TRAINS, SELF, sw_411_livery_choice_decider, livery_choice){
 1 : sw_411_manual_livery_decider ;
 sw_411_passenger_livery_decider ;
}

switch(FEAT_TRAINS, SELF, sw_411_livery_choice_decider_t, livery_choice){
 1 : sw_411_manual_livery_decider_t ;
 sw_411_passenger_livery_decider_t ;
}

//Refit text

switch(FEAT_TRAINS, SELF, sw_411_refit_text, cargo_subtype){
 0: string(STR_LIVERY_BRGREEN);
 1: string(STR_LIVERY_BRBLUE);
 2: string(STR_LIVERY_NSE);
 3: string(STR_LIVERY_SWT);
 4: string(STR_LIVERY_CONNEX);
 5: string(STR_LIVERY_SWT_HERITAGE);
 return CB_RESULT_NO_TEXT;
}

switch(FEAT_TRAINS, SELF, sw_411_refit_text_decider, livery_choice){
 1 : sw_411_refit_text ;
 return CB_RESULT_NO_TEXT ;
}

//Purchase sprite decider
switch(FEAT_TRAINS, SELF, sw_411_purchase, current_year){
 0 .. 1963: spriteset_411_green_purchase;
 1964 .. 1982: spriteset_411_blue_grey_purchase;
 1983 .. 1995: spriteset_411_nse_purchase;
 1996 .. 2004: spriteset_411_swt_purchase;
 2005 .. 2008: spriteset_411_cnx_purchase;
 spriteset_411_heritage_purchase;
}

switch(FEAT_TRAINS, SELF, sw_411_default, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_411_livery_choice_decider;
}

switch(FEAT_TRAINS, SELF, sw_411_default_t, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_411_livery_choice_decider_t;
}

//Recolour

random_switch(FEAT_TRAINS, SELF, sw_411_green_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1: palette_2cc(COLOUR_DARK_GREEN, COLOUR_YELLOW) ;
}

random_switch(FEAT_TRAINS, SELF, sw_411_blue_grey_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_WHITE) ;
}

random_switch(FEAT_TRAINS, SELF, sw_411_nse_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1: palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ;
}

random_switch(FEAT_TRAINS, SELF, sw_411_swt_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_RED) ;
}

random_switch(FEAT_TRAINS, SELF, sw_411_cnx_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_DARK_BLUE, COLOUR_YELLOW) ;
}

random_switch(FEAT_TRAINS, SELF, sw_411_heritage_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1 : palette_2cc(COLOUR_LIGHT_BLUE, COLOUR_WHITE) ;
}

//Recolour Switches

switch(FEAT_TRAINS, SELF, sw_411_colour_mapping_auto, current_year){
 0 .. 1963: sw_411_green_colour_mapping;
 1964 .. 1982: sw_411_blue_grey_colour_mapping;
 1983 .. 1995: sw_411_nse_colour_mapping;
 1996 .. 2004: sw_411_swt_colour_mapping;
 2005 .. 2008: sw_411_cnx_colour_mapping;
 sw_411_heritage_colour_mapping;
}

switch(FEAT_TRAINS, SELF, sw_411_colour_mapping_manual, cargo_subtype){
 0: sw_411_green_colour_mapping;
 1: sw_411_blue_grey_colour_mapping;
 2: sw_411_nse_colour_mapping;
 3: sw_411_swt_colour_mapping;
 4: sw_411_cnx_colour_mapping;
 5: sw_411_heritage_colour_mapping;
 return CB_RESULT_NO_TEXT;
}

switch(FEAT_TRAINS, PARENT, sw_411_colour_mapping_manual_check, livery_choice){
 1 : sw_411_colour_mapping_manual ;
 sw_411_colour_mapping_auto ;
}

switch(FEAT_TRAINS, PARENT, sw_411_colour_mapping_decider, colour_scheme_1){
 1 : sw_411_colour_mapping_manual_check ;
 palette_2cc(company_colour1, company_colour2) ;
}

switch(FEAT_TRAINS, SELF, sw_411_coupling_restrictions, vehicle_type_id) {
    9010: return CB_RESULT_ATTACH_ALLOW;
 411: return CB_RESULT_ATTACH_ALLOW;
    return string(STR_411_NO_COUPLE);
}

item (FEAT_TRAINS, item_411, 411) {
 property {
  name: string(STR_NAME_411);
  climates_available: ALL_CLIMATES;
  introduction_date: date(1956, 1, 1);
  model_life: 30;
  retire_early: 1;
  vehicle_life: 50;
  reliability_decay: 7;
  refittable_cargo_classes: bitmask(CC_PASSENGERS);
  cargo_allow_refit: [PASS, TOUR];
  loading_speed: 27;
  cost_factor: 40;
  running_cost_factor: 25;
  sprite_id: SPRITE_ID_NEW_TRAIN;
  speed: 90 mph;
  misc_flags: bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_2CC);
  refit_cost: 0;
  track_type: SAA3;
  ai_special_flag: AI_FLAG_CARGO;
  power: 500 hp;
  running_cost_base: RUNNING_COST_ELECTRIC;
  dual_headed: 1;
  default_cargo_type: PASS;
  cargo_capacity: 90;
  weight: 30 ton;
  engine_class: ENGINE_CLASS_ELECTRIC;
  tractive_effort_coefficient: 0.35;
  air_drag_coefficient: 0.05;
  length: 8;
  effect_spawn_model_and_powered: EFFECT_SPAWN_MODEL_ELECTRIC;
  bitmask_vehicle_info: 0;
  cargo_age_period: 185;
  default_cargo_type: PASS;
 }
 graphics {
 can_attach_wagon: sw_411_coupling_restrictions;
 default: sw_411_default;
 purchase: sw_411_purchase;
 create_effect: vfx_3rd;
 cargo_subtype_text: sw_411_refit_text_decider ;
 colour_mapping: sw_411_colour_mapping_decider;
 //sound_effect:						sw_sfx_electric_loco;
}
  livery_override (9010) {
  cargo_capacity: 90;
  default: sw_411_default_t;
  colour_mapping: sw_411_colour_mapping_decider;
  cargo_subtype_text: sw_411_refit_text_decider ;
}
}
# 24 "rukts.pnml" 2
# 1 "src/EMU/class_700.pnml" 1
spriteset(spriteset_700_tl_f, "gfx/EMU/class_700.png") {
 template_8_8(0, 0)
}

spriteset(spriteset_700_tl_r, "gfx/EMU/class_700.png") {
 template_8_8(0, 25)
}

spriteset(spriteset_700_tl_o, "gfx/EMU/class_700.png") {
 template_8_8(0, 50)
}

spriteset(spriteset_700_tl_t, "gfx/EMU/class_700.png") {
 template_8_8(0, 75)
}

spriteset(spriteset_700_tl_p, "gfx/EMU/class_700.png") {
 template_8_8(0, 100)
}

spriteset(spriteset_700_swt_f, "gfx/EMU/class_700.png") {
 template_8_8(0, 125)
}

spriteset(spriteset_700_swt_r, "gfx/EMU/class_700.png") {
 template_8_8(0, 150)
}

spriteset(spriteset_700_swt_o, "gfx/EMU/class_700.png") {
 template_8_8(0, 175)
}

spriteset(spriteset_700_swt_t, "gfx/EMU/class_700.png") {
 template_8_8(0, 200)
}

spriteset(spriteset_700_purchase, "gfx/EMU/class_700.png") {
 template_dualhead_purchase(179, 0)
}

//Switches


switch(FEAT_TRAINS, SELF, sw_700_front, position_in_consist){
 0: spriteset_700_tl_f;
 spriteset_700_tl_o;
}
switch(FEAT_TRAINS, SELF, sw_700_tl_select, position_in_consist_from_end){
 0: spriteset_700_tl_r;
 return sw_700_front;
}
switch(FEAT_TRAINS, SELF, sw_700_tl_t_select, position_in_vehid_chain){
 0: spriteset_700_tl_p;
 spriteset_700_tl_t;
}
random_switch(FEAT_TRAINS, SELF, sw_700, TRIGGER_VEHICLE_SERVICE){1:sw_700_tl_select;}
random_switch(FEAT_TRAINS, SELF, sw_700_t, TRIGGER_VEHICLE_SERVICE){1: sw_700_tl_t_select;}

switch(FEAT_TRAINS, SELF, sw_707_front, position_in_consist){
 0: spriteset_700_swt_f;
 spriteset_700_swt_o;
}
switch(FEAT_TRAINS, SELF, sw_707_swt_select, position_in_consist_from_end){
 0: spriteset_700_swt_r;
 return sw_707_front;
}
switch(FEAT_TRAINS, SELF, sw_707_swt_t_select, position_in_vehid_chain){
 0: spriteset_700_swt_t;
 spriteset_700_swt_t;
}
random_switch(FEAT_TRAINS, SELF, sw_707, TRIGGER_VEHICLE_SERVICE){1:sw_707_swt_select;}
random_switch(FEAT_TRAINS, SELF, sw_707_t, TRIGGER_VEHICLE_SERVICE){1: sw_707_swt_t_select;}

//How the livery is selected

switch(FEAT_TRAINS, SELF, sw_700_livery_selection_auto, (count_veh_id(0)/count_veh_id(1))){
 0..1: sw_707;
  sw_700;
}

switch(FEAT_TRAINS, PARENT, sw_700_livery_selection_auto_t, (count_veh_id(0)/count_veh_id(1))){
 0..1: sw_707_t;
  sw_700_t;
}

switch(FEAT_TRAINS, SELF, sw_700_livery_selection_manual, cargo_subtype){
 0: sw_700;
 1: sw_707;
}

switch(FEAT_TRAINS, PARENT, sw_700_livery_selection_manual_t, cargo_subtype){
 0: sw_700_t;
 1: sw_707_t;
}

switch(FEAT_TRAINS, SELF, sw_700_livery_selection, livery_choice){
 1: sw_700_livery_selection_manual;
 sw_700_livery_selection_auto;
}

switch(FEAT_TRAINS, SELF, sw_700_livery_selection_t, livery_choice){
 1: sw_700_livery_selection_manual_t;
 sw_700_livery_selection_auto_t;
}

switch(FEAT_TRAINS, SELF, sw_700_default, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_700_livery_selection;
}

switch(FEAT_TRAINS, SELF, sw_700_trailer, [STORE_TEMP((getbits(extra_callback_info1, 8, 8) < 2 ? CB_FLAG_MORE_SPRITES : 0) | PALETTE_USE_DEFAULT, 0x100), getbits(extra_callback_info1, 8, 8)]){
 0 : return sw_700_livery_selection_t;
}

//Refit text

switch(FEAT_TRAINS, SELF, sw_700_refit_text, cargo_subtype){
 0: string(STR_LIVERY_THAMESLINK);
 1: string(STR_LIVERY_SWT);
 return CB_RESULT_NO_TEXT;
}

switch(FEAT_TRAINS, SELF, sw_700_refit_text_decider, livery_choice){
 1 : sw_700_refit_text ;
 return CB_RESULT_NO_TEXT ;
}

//Recolour options

random_switch(FEAT_TRAINS, SELF, sw_707_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1: palette_2cc(COLOUR_RED, COLOUR_DARK_BLUE) ;
}

random_switch(FEAT_TRAINS, SELF, sw_700_tl_colour_mapping, TRIGGER_VEHICLE_SERVICE){
 1: palette_2cc(company_colour1, COLOUR_LIGHT_BLUE) ;
}

//Recolour decicsion

switch(FEAT_TRAINS, PARENT, sw_700_recolour_selection_auto, (count_veh_id(0)/count_veh_id(1))){
 0..1: sw_707_colour_mapping;
  sw_700_tl_colour_mapping;
}

switch(FEAT_TRAINS, SELF, sw_700_recolour_selection_manual, cargo_subtype){
 0: sw_700_tl_colour_mapping;
 1: sw_707_colour_mapping;
}

switch(FEAT_TRAINS, SELF, sw_700_recolour_livery_selection, livery_choice){
 1: sw_700_recolour_selection_manual;
 sw_700_recolour_selection_auto;
}

switch(FEAT_TRAINS, PARENT, sw_700_colour_mapping, colour_scheme_1){
 1 : sw_700_recolour_livery_selection ;
 palette_2cc(company_colour1, company_colour2) ;
}

switch(FEAT_TRAINS, SELF, sw_700_coupling_restrictions, vehicle_type_id) {
    item_MU90: return CB_RESULT_ATTACH_ALLOW;
 item_700: return CB_RESULT_ATTACH_ALLOW;
    return string(STR_700_NO_COUPLE);
}

item (FEAT_TRAINS, item_700, 700) {
 property {
  name: string(STR_NAME_700);
  climates_available: ALL_CLIMATES;
  introduction_date: date(2015, 1, 1);
  model_life: 15;
  retire_early: 1;
  vehicle_life: 50;
  reliability_decay: 7;
  refittable_cargo_classes: CC_PASSENGERS;
  cargo_allow_refit: [PASS, TOUR];
  loading_speed: 35;
  cost_factor: 75;
  running_cost_factor: 60;
  sprite_id: SPRITE_ID_NEW_TRAIN;
  speed: 100 mph;
  misc_flags: bitmask(TRAIN_FLAG_MU, TRAIN_FLAG_2CC);
  refit_cost: 0;
  track_type: SAAZ;
  ai_special_flag: AI_FLAG_CARGO;
  power: 2234 hp;
  running_cost_base: RUNNING_COST_ELECTRIC;
  dual_headed: 1;
  default_cargo_type: PASS;
  cargo_capacity: 90;
  weight: 34 ton;
  engine_class: ENGINE_CLASS_ELECTRIC;
  tractive_effort_coefficient: 0.11;
  air_drag_coefficient: 0.06;
  length: 8;
  effect_spawn_model_and_powered: EFFECT_SPAWN_MODEL_ELECTRIC;
  bitmask_vehicle_info: 0;
 }
 graphics {
 can_attach_wagon: sw_700_coupling_restrictions;
 default: sw_700_default;
 purchase: spriteset_700_purchase;
 create_effect: vfx_dual_voltage;
 colour_mapping: sw_700_colour_mapping;
 cargo_subtype_text: sw_700_refit_text_decider;
 purchase_colour_mapping: sw_707_colour_mapping;
}
  livery_override (item_MU90) {
  cargo_capacity: 90;
  power: 447;
  default: sw_700_trailer;
  weight: 34;
  colour_mapping: sw_700_colour_mapping;
  cargo_subtype_text: sw_700_refit_text_decider;
}
}
# 25 "rukts.pnml" 2
# 1 "src/CODE/purchase_list_sort.pnml" 1
# 26 "rukts.pnml" 2
# 1 "src/CODE/sort_purchase.pnml" 1
sort(FEAT_TRAINS,[
40,
70,
68,
142,
87,
88,
411,
325,
700,
9010,
9020,
9090,
]);
# 26 "rukts.pnml" 2
